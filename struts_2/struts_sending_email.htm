<!doctype html> 
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]> <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]> <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]> <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--><html lang="en"><!--<![endif]-->

<!-- Mirrored from www.tutorialspoint.com/struts_2/struts_sending_email.htm by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 13 Apr 2013 21:12:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8">
<title>Struts 2 Sending Email</title>
<link rel="shortcut icon" href="../favicon.png" type="image/x-icon" />
<meta name="description" content="Struts 2 Sending Email with Example - Learn what is Basic Model View and Controller Architecture along with Struts 2 in simple and easy steps starting from Environment Setup, Architecture, Configuration, Actions, Interceptors, Results, Result Types, File Uploads, Database Access, Validations, Localization, Type Conversion, Tag Library, Exeption Handling and Annotations." />
<meta name="Keywords" content="Struts, Tutorials, Learning, Beginners, Environment Setup, Architecture, Configuration, Actions, Interceptors, Results, Result Types, File Uploads, Database Access, Validations, Localization, Type Conversion, Tag Library, Exeption Handling, Annotations." />
<base  />
<link rel="stylesheet" type="text/css" href="../scripts/style.css" />
<link rel="stylesheet" type="text/css" href="../scripts/prettify.css" />
<script type="text/javascript" src="../scripts/prettify.js"></script>
<style media="screen" type="text/css">
#topmenu a:hover {text-decoration:none;color:#5c83ba !important;background-color:transparent;font-weight:bold;}
#header{ 
background:#5c83ba !important;
}
#topmenu
{
background-color:#121212 !important;
}
#leftcol ul.menu li.heading 
{
background:#5c83ba !important;
border:1px solid #121212 !important;
}
#leftcol, #middlecol, #rightcol {min-height:1020px; padding:0px;}
</style>
<script src="../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-232293-6";
urchinTracker();
</script>
</head>
<body onload="prettyPrint()">
<div id="header">
<div class="wrapper">
<h1 class="logo"><a href="../index.htm">Tutorials Point - Simply Easy Learning</a></h1>
<div id="search">
<form method="get" id="searchform" name="searchform" action="http://www.google.com/search" target="_blank">
<input type="hidden" name="sitesearch" value="www.tutorialspoint.com"/>
<input type="text" name="as_q" id="s" value="Search this site..." onfocus="if (this.value == 'Search this site...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search this site...';}"/>
<input value="FORID:11" name="cof" type="hidden"/>
<input type="hidden" name="ie" value="ISO-8859-1" />
<input class="submit btn" type="image" src="../images/icon-search.png" alt="Go"/>
</form>
</div>
</div>
</div>
<div id="topmenu">
<div class="wrapper">
<div id="left">
<a href="../index.htm" target="_top">HOME </a>
<a href="../java/index.htm" target="_top">JAVA </a>
<a href="../php/index.htm" target="_top">PHP </a>
<a href="../python/index.htm" target="_top">Python </a>
<a href="../ruby/index.htm" target="_top">Ruby </a>
<a href="../perl/index.htm" target="_top">Perl </a>
<a href="../html/index.htm" target="_top">HTML </a>
<a href="../css/index.htm" target="_top">CSS </a>
<a href="../javascript/index.htm" target="_top">Javascript </a>
<a href="../mysql/index.htm" target="_top">MySQL </a>
<a href="../cplusplus/index.htm" target="_top">C++ </a>
<a href="../unix/index.htm" target="_top">UNIX </a>
<a href="../more.htm" target="_top">MORE...</a>
</div>
<div id="right">
<a href="../references.htm" target="_top">REFERENCES</a> |
<a href="../forums/index.html" target="_top">FORUM</a> |
<a href="../about/index.htm" target="_top">ABOUT</a> |
<a href="../about/contact_us.htm" target="_top">CONTACT</a>
</div>
</div>
</div>
<div class="wrapper">
<div id="leftcol">
<div class="mini-logo">
<img src="../images/struts-mini-logo.png" alt="Struts Tutorial" />
</div>
<ul class="menu">
<li class="heading">Struts 2 Basics</li>
<li><a class="left" target="_top" href="index.htm">Struts2 Home</a></li>
<li><a class="left" target="_top" href="basic_mvc_architecture.htm">Basic MVC Architecture</a></li>
<li><a class="left" target="_top" href="struts_overview.htm">Struts2 Overview</a></li>
<li><a class="left" target="_top" href="struts_environment_setup.htm">Struts2 Environment Setup</a></li>
<li><a class="left" target="_top" href="struts_architecture.htm">Struts2 Architecture</a></li>
<li><a class="left" target="_top" href="struts_examples.htm">Struts2 Examples</a></li>
<li><a class="left" target="_top" href="struts_configuration.htm">Struts2 Configuration</a></li>
<li><a class="left" target="_top" href="struts_actions.htm">Struts2 Actions</a></li>
<li><a class="left" target="_top" href="struts_interceptors.htm">Struts2 Interceptors</a></li>
<li><a class="left" target="_top" href="struts_result_types.htm">Struts2 Result Types</a></li>
<li><a class="left" target="_top" href="struts_value_stack_ognl.htm">Struts2 Value Stack/OGNL</a></li>
<li><a class="left" target="_top" href="struts_file_uploads.htm">Struts2 File Uploads</a></li>
<li><a class="left" target="_top" href="struts_database_access.htm">Struts2 Database Access</a></li>
<li><a class="left" target="_top" href="struts_sending_email.htm"><b>Struts2 Sending Email</b></a></li>
<li><a class="left" target="_top" href="struts_validations.htm">Struts2 Validations</a></li>
<li><a class="left" target="_top" href="struts_localization.htm">Struts2 Localization</a></li>
<li><a class="left" target="_top" href="struts_type_conversion.htm">Struts2 Type Conversion</a></li>
<li><a class="left" target="_top" href="struts_themes_templates.htm">Struts2 Themes/Templates</a></li>
<li><a class="left" target="_top" href="struts_exception_handling.htm">Struts2 Exception Handling</a></li>
<li><a class="left" target="_top" href="struts_annotations.htm">Struts2 Annotations</a></li>
</ul>
<ul class="menu">
<li class="heading">Struts 2 Tags</li>
<li><a class="left" target="_top" href="struts_control_tags.htm">Struts2 Control Tags</a></li>
<li><a class="left" target="_top" href="struts_data_tags.htm">Struts2 Data Tags</a></li>
<li><a class="left" target="_top" href="struts_form_tags.htm">Struts2 Form Tags</a></li>
<li><a class="left" target="_top" href="struts_ajax_tags.htm">Struts2 Ajax Tags</a></li>
</ul>
<ul class="menu">
<li class="heading">Struts 2 Integrations</li>
<li><a class="left" target="_top" href="struts_spring.htm">Struts2 - Spring</a></li>
<li><a class="left" target="_top" href="struts_tiles.htm">Struts2 - Tiles</a></li>
<li><a class="left" target="_top" href="struts_hibernate.htm">Struts2 - Hibernate</a></li>
</ul>
<ul class="menu">
<li class="heading">Struts 2 Useful Resources</li>
<li><a class="left" target="_top" href="struts_quick_guide.htm">Struts2 Quick Guide</a></li>
<li><a class="left" target="_top" href="struts_useful_resources.htm">Struts2 Useful Resources</a></li>
</ul>
<ul class="menu">
<li class="sreading">Selected Reading</li>
<li><a target="_top" href="../developers_best_practices/index.htm">Developer's Best Practices</a></li>
<li><a target="_top" href="../computer_glossary.htm">Computer Glossary</a></li>
<li><a target="_top" href="../computer_whoiswho.htm">Who is Who</a></li>
</ul>
</div><!-- leftcol -->
<div id="middlecol">
<!-- PRINTING STARTS HERE -->
<div class="content">
<h1>Struts 2 Sending Email</h1>
<div class="topgooglead">
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "image";
google_ad_channel = "";
//--></script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/show_ads.js"> 
</script>
</div>
<hr />
<div class="pre-btn">
<a href="struts_database_access.htm">Previous Page</a>
</div>
<div class="nxt-btn">
<a href="struts_validations.htm">Next Page</a>
</div>
<div class="clearer"></div>
<hr />
<p>This chapter will teach you how yYou can send an email using your Struts 2 application. For this exercise, you need to download and install the mail.jar from <a target="_blank" rel="nofollow" href="http://www.oracle.com/technetwork/java/javasebusiness/downloads/java-archive-downloads-eeplat-419426.html#javamail-1.4.4-oth-JPR">JavaMail API 1.4.4</a> and place the <b>mail.jar</b> file in your WEB-INF\lib folder and then proceed to follow the standard steps of creating action, view and configuration files.</p>
<h2>Create Action:</h2>
<p>The next step is to create an Action method that takes care of sending the email. Let us create a new class called <b>Emailer.java</b> with the following contents.</p>
<pre class="prettyprint">
package com.tutorialspoint.struts2;

import java.util.Properties;
import javax.mail.Message;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

import com.opensymphony.xwork2.ActionSupport;

public class Emailer extends ActionSupport {

   private String from;
   private String password;
   private String to;
   private String subject;
   private String body;

   static Properties properties = new Properties();
   static
   {
      properties.put("mail.smtp.host", "smtp.gmail.com");
      properties.put("mail.smtp.socketFactory.port", "465");
      properties.put("mail.smtp.socketFactory.class",
                     "javax.net.ssl.SSLSocketFactory");
      properties.put("mail.smtp.auth", "true");
      properties.put("mail.smtp.port", "465");
   }

   public String execute() 
   {
      String ret = SUCCESS;
      try
      {
         Session session = Session.getDefaultInstance(properties,  
            new javax.mail.Authenticator() {
            protected PasswordAuthentication 
            getPasswordAuthentication() {
            return new 
            PasswordAuthentication(from, password);
            }});

         Message message = new MimeMessage(session);
         message.setFrom(new InternetAddress(from));
         message.setRecipients(Message.RecipientType.TO, 
            InternetAddress.parse(to));
         message.setSubject(subject);
         message.setText(body);
         Transport.send(message);
      }
      catch(Exception e)
      {
         ret = ERROR;
         e.printStackTrace();
      }
      return ret;
   }

   public String getFrom() {
      return from;
   }

   public void setFrom(String from) {
      this.from = from;
   }

   public String getPassword() {
      return password;
   }

   public void setPassword(String password) {
      this.password = password;
   }

   public String getTo() {
      return to;
   }

   public void setTo(String to) {
      this.to = to;
   }

   public String getSubject() {
      return subject;
   }

   public void setSubject(String subject) {
      this.subject = subject;
   }

   public String getBody() {
      return body;
   }

   public void setBody(String body) {
      this.body = body;
   }

   public static Properties getProperties() {
      return properties;
   }

   public static void setProperties(Properties properties) {
      Emailer.properties = properties;
   }
}
</pre>
<p>As seen in the source code above, the <b>Emailer.java</b> has properties that correspond to the form attributes in the email.jsp page given below. These attributes are</p>
<ul class="list">
<li><p><b>from</b> - The email address of the sender. As we are using Google's SMTP, we need a valid gtalk id</p></li>
<li><p><b>password</b> - The password of the above account</p></li>
<li><p><b>to</b> - Who to send the email to?</p></li>
<li><p><b>Subject</b> - subject of the email</p></li>
<li><p><b>body</b> - The actual email message</p></li>
</ul>
<p>We have not considered any validations on the above fields, validations will be added in the next chapter. Let us now look at the execute() method. The execute() method uses the javax Mail library to send an email using the supplied parameters. If the mail is sent successfuly, action returns SUCCESS, otherwise it returns ERROR.</p>
<h2>Create main page:</h2>
<p>Let us write main page JSP file <b>index.jsp</b>, which will be used to collect email related information mentioned above:</p>
<pre class="prettyprint">
&lt;%@ page language="java" contentType="text/html; charset=ISO-8859-1"
   pageEncoding="ISO-8859-1"%&gt;
&lt;%@ taglib prefix="s" uri="/struts-tags"%&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
"http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Email Form&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
   &lt;em&gt;The form below uses Google's SMTP server. 
   So you need to enter a gmail username and password
   &lt;/em&gt;
   &lt;form action="emailer" method="post"&gt;
   &lt;label for="from"&gt;From&lt;/label&gt;&lt;br/&gt;
   &lt;input type="text" name="from"/&gt;&lt;br/&gt;
   &lt;label for="password"&gt;Password&lt;/label&gt;&lt;br/&gt;
   &lt;input type="password" name="password"/&gt;&lt;br/&gt;
   &lt;label for="to"&gt;To&lt;/label&gt;&lt;br/&gt;
   &lt;input type="text" name="to"/&gt;&lt;br/&gt;
   &lt;label for="subject"&gt;Subject&lt;/label&gt;&lt;br/&gt;
   &lt;input type="text" name="subject"/&gt;&lt;br/&gt;
   &lt;label for="body"&gt;Body&lt;/label&gt;&lt;br/&gt;
   &lt;input type="text" name="body"/&gt;&lt;br/&gt;
   &lt;input type="submit" value="Send Email"/&gt;
   &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
<h2>Create Views:</h2>
<p>We will use JSP file <b>success.jsp</b> which  will be invoked in case action returns SUCCESS, but we will have another view file in case of an ERROR is returned from the action.</p>
<pre class="prettyprint">
&lt;%@ page language="java" contentType="text/html; charset=ISO-8859-1"
	pageEncoding="ISO-8859-1"%&gt;
&lt;%@ taglib prefix="s" uri="/struts-tags"%&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
"http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Email Success&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
   Your email to &lt;s:property value="to"/&gt; was sent successfully.
&lt;/body&gt;
&lt;/html&gt;
</pre>
<p>Following will be the view file <b>error.jsp</b> in case of an ERROR is returned from the action.</p>
<pre class="prettyprint">
&lt;%@ page language="java" contentType="text/html; charset=ISO-8859-1"
	pageEncoding="ISO-8859-1"%&gt;
&lt;%@ taglib prefix="s" uri="/struts-tags"%&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
"http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Email Error&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
   There is a problem sending your email to &lt;s:property value="to"/&gt;.
&lt;/body&gt;
&lt;/html&gt;
</pre>
<h2>Configuration Files:</h2>
<p>Now let us put everything together using the struts.xml configuration file as follows:</p>
<pre class="prettyprint">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE struts PUBLIC
   "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
   "http://struts.apache.org/dtds/struts-2.0.dtd"&gt;

&lt;struts&gt;

   &lt;constant name="struts.devMode" value="true" /&gt;
   &lt;package name="helloworld" extends="struts-default"&gt;

      &lt;action name="emailer" 
         class="com.tutorialspoint.struts2.Emailer"
         method="execute"&gt;
         &lt;result name="success"&gt;/success.jsp&lt;/result&gt;
         &lt;result name="error"&gt;/error.jsp&lt;/result&gt;
      &lt;/action&gt;

   &lt;/package&gt;

&lt;/struts&gt;
</pre>
<p>Following is the content of <b>web.xml</b> file:</p>
<pre class="prettyprint">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns="http://java.sun.com/xml/ns/javaee" 
   xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
   xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
   http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
   id="WebApp_ID" version="3.0"&gt;
   
   &lt;display-name&gt;Struts 2&lt;/display-name&gt;
   &lt;welcome-file-list&gt;
      &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;
   &lt;/welcome-file-list&gt;

   &lt;filter&gt;
      &lt;filter-name&gt;struts2&lt;/filter-name&gt;
      &lt;filter-class&gt;
         org.apache.struts2.dispatcher.FilterDispatcher
      &lt;/filter-class&gt;
   &lt;/filter&gt;

   &lt;filter-mapping&gt;
      &lt;filter-name&gt;struts2&lt;/filter-name&gt;
      &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
   &lt;/filter-mapping&gt;
&lt;/web-app&gt;
</pre>
<p>Now, right click on the project name and click <b>Export &gt; WAR File</b> to create a War file. Then deploy this WAR in the Tomcat's webapps directory. Finally, start Tomcat server and try to access URL http://localhost:8080/HelloWorldStruts2/index.jsp. This will give you following screen:</p>
<center>
<img class="main" src="../images/helloworldstruts12.jpg" alt="Email User Input" />
</center>
<p>Enter the required information and click <b>Send Email</b> button. If everything goes fine then you should see the following page</p>
<center>
<img class="main" src="../images/helloworldstruts13.jpg" alt="Email Successful" />
</center>
<hr />
<div class="pre-btn">
<a href="struts_database_access.htm">Previous Page</a>
</div>
<div class="print-btn">
<a href="../cgi-bin/printpage.html" target="_blank">Print Version</a>
</div>
<div class="pdf-btn">
<a href="pdf/struts_sending_email.pdf" alt="Struts 2 Sending Email" target="_blank">PDF Version</a>
</div>
<div class="nxt-btn">
<a href="struts_validations.htm">Next Page</a>
</div>
<div class="clearer"></div>
<hr />
</div>
<!-- PRINTING ENDS HERE -->
<div class="bottomgooglead">
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 336;
google_ad_height = 280;
google_ad_format = "336x280_as";
google_ad_type = "text";
google_ad_channel ="9030538898";
google_color_border="ffffff";
google_color_link="900b09";
google_color_url="000000";
google_color_text="000000";
//--></script>
<script type="text/javascript" src="../../pagead2.googlesyndication.com/pagead/show_ads.js"></script>
</div>
</div><!-- middlecol -->
<div id="rightcol">
<!-- AddThis Button BEGIN -->
<div class="addthis">
<div class="addthis_toolbox addthis_default_style">
<a class="addthis_button_facebook"></a>
<a class="addthis_button_twitter"></a>
<script type="text/javascript">
<!--
 document.write('<a class="addthis_button_google_plusone" g:plusone:count="false"></a>');
//-->
</script>
<a class="addthis_button_linkedin"></a>
<a class="addthis_button_email"></a>
<a class="addthis_button_compact"></a>
</div>
<script type="text/javascript" src="../../s7.addthis.com/js/250/addthis_widget.js#pubid=ra-4f661ec623a400f0"></script>
</div>
<!-- AddThis Button END -->
<div class="localad">
<a rel="nofollow" href="http://www.modernindianbabynames.com/" target="_blank" title="Modern Baby Names">Modern Baby Names</a>
</div>
<div class="localad">
<a rel="nofollow" href="http://www.photofuntoos.com/" target="_blank" title="Online Photo Editing">Online Photo Editing</a>
</div>
<div class="rightgooglead">
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/show_ads.js"> 
</script>
</div>
</div><!-- rightcol -->
<div style="clear:both;"></div>
</div><!-- wrapper -->
<div id="footer">
<div class="wrapper">
<div id="bottommenu">
<a href="../asp.net/index.htm" target="_top">ASP.NET </a> |
<a href="../jquery/index.htm" target="_top">jQuery </a> |
<a href="../ajax/index.htm" target="_top">AJAX </a> |
<a href="../ant/index.htm" target="_top">ANT</a> |
<a href="../jsp/index.htm" target="_top">JSP </a> |
<a href="../servlets/index.htm" target="_top">Servlets </a> |
<a href="../log4j/index.htm" target="_top">log4j </a> |
<a href="../ibatis/index.htm" target="_top">iBATIS </a> |
<a href="../hibernate/index.htm" target="_top">Hibernate </a> |
<a href="../jdbc/index.htm" target="_top">JDBC </a> |
<a href="index.htm" target="_top">Struts </a> |
<a href="../html5/index.htm" target="_top">HTML5 </a> |
<a href="../sql/index.htm" target="_top">SQL </a> |
<a href="../mysql/index.htm" target="_top">MySQL </a> |
<a href="../cplusplus/index.htm" target="_top">C++ </a> |
<a href="../unix/index.htm" target="_top">UNIX </a>
</div>
<div id="copyright">
<p>Copyright &copy; 2013 by tutorialspoint. All Rights Reserved.</p>
</div>
</div>
</div>
</body>

<!-- Mirrored from www.tutorialspoint.com/struts_2/struts_sending_email.htm by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 13 Apr 2013 21:12:33 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
</html>