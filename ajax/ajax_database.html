<html>

<!-- Mirrored from www.tutorialspoint.com/ajax/ajax_database.htm by HTTrack Website Copier/3.x [XR&CO'2010], Mon, 15 Apr 2013 05:01:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<title>AJAX and Database Operations</title>
<link rel="shortcut icon" href="../favicon.png" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="Keywords" content="AJAX, Tutorial, Learning, beginner, XMLHttpRequest, Response, ActiveXObject, Msxml2.XMLHTTP, Microsoft.XMLHTTP, Database Support, DOM Manipulation, Security Issues." />
<meta name="description" content="AJAX and Database Operations - Learning AJAX in simple and easy steps. A beginner's tutorial containing complete knowledge of AJAX, XMLHttpRequest, Response, ActiveXObject, Msxml2.XMLHTTP, Microsoft.XMLHTTP, Database Support, DOM Manipulation, Security Issues." />
<base >
<link rel="stylesheet" type="text/css" href="../tp.css" />
<script src="../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-232293-6";
urchinTracker();
</script>
</head>
<body>
<center>
<table border=0 class="main" cellpadding="2" cellspacing="0">
<tr>
<td class="content" valign="top" align="left">
<a href="../index-2.html"><img src="../images/tp-logo.gif" border=0  alt="Tutorials Point"></a>
<br>
<br>
<div  class="search">
<!-- SiteSearch Google -->
<form method="get" action="http://www.google.com/custom" target="google_window">
<table border="0">
<tr><td nowrap="nowrap" valign="top" align="center" height="32">
<a href="http://www.google.com/">
<img src="../../www.google.com/logos/Logo_25wht.gif" border="0" alt="Google" align="middle"></img></a>
</td>
</tr>
<tr>
<td nowrap="nowrap">
<input type="hidden" name="domains" value="www.tutorialspoint.com"></input>
<input type="text" name="q" size="18" maxlength="255" value=""></input>
<input type="submit" name="sa" style="width:20px;font-weight:bold" value="..."></input>
</td></tr>
<tr>
<td nowrap="nowrap">
<table>
<tr>
<td>
<input type="radio" name="sitesearch" value="" checked="checked"></input>
<font size="-1" color="#000000">Web</font>
</td>
<td>
<input type="radio" name="sitesearch" value="www.tutorialspoint.com"></input>
<font size="-1" color="#000000">This Site</font>
</td>
</tr>
</table>
<input type="hidden" name="client" value="pub-7133395778201029"></input>
<input type="hidden" name="forid" value="1"></input>
<input type="hidden" name="ie" value="ISO-8859-1"></input>
<input type="hidden" name="oe" value="ISO-8859-1"></input>
<input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:336699;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;FORID:1"></input>
<input type="hidden" name="hl" value="en"></input>
</td></tr></table>
</form>
<!-- SiteSearch Google -->
</div>
<br>
&nbsp;&nbsp;<b>AJAX Tutorial</b>
<div  class="left">
<ul class="menu">
<li><a class="left" target="_top" href="index.html">AJAX HOME</a></li>
<li><a class="left" target="_top" href="what_is_ajax.html" >What is AJAX ?</a></li>
<li><a class="left" target="_top" href="ajax_technology.html" >AJAX Technologies</a></li>
<li><a class="left" target="_top" href="ajax_examples.html" >AJAX Examples</b></a></li>
<li><a class="left" target="_top" href="ajax_browser_support.html" >Browser Support</a></li>
<li><a class="left" target="_top" href="ajax_in_action.html" >AJAX in Action</a></li>
<li><a class="left" target="_top" href="what_is_xmlhttprequest.html" >AJAX XMLHttpRequest</a></li>
<li><a class="left" target="_top" href="ajax_database.html" ><b>AJAX Database</b></a></li>
<li><a class="left" target="_top" href="ajax_security.html" >AJAX Security</a></li>
<li><a class="left" target="_top" href="ajax_issues.html" >Issues with AJAX</a></li>
</ul>
</div>
<br />
&nbsp;&nbsp;<b>Selected Reading</b>
<div  class="left">
<ul class="menu">
<li><a class="left" target="_top" href="../computer_glossary.html">Computer Glossary</b></a></li>
<li><a class="left" target="_top" href="../computer_whoiswho.html">Who is Who</a></li>
</ul>
</div>
<br /><br />
<small>&copy; 2013 TutorialsPoint.COM </small>
</td>
<td valign="top">
<br><br>
<table cellpadding="0" cellspacing="0">
<tr valign="middle">
<td  style="width:20px;"></td>
<td  class="top">
&nbsp;&nbsp;<a class="top" href="../index-2.html">Home</a>&nbsp;&nbsp;
</td>
<td  style="width:20px;"></td>
<td  class="top">
&nbsp;&nbsp;<a class="top" href="../references.html">References</a>&nbsp;&nbsp;
</td>
<td  style="width:20px;"></td>
<td  class="top">
&nbsp;&nbsp;<a class="top" href="../about/index.html">About TP</a>&nbsp;&nbsp;
</td>
<td  style="width:10px;"></td>
<td  class="top">
&nbsp;&nbsp;<a class="top" href="../about/about_advertising.html">Advertising</a>&nbsp;&nbsp;
</td>
</tr>
</table>
<table class="middle"  cellpadding="5" cellspacing="0">
<tr>
<td>
<!-- PRINTING STARTS HERE -->
<h1>AJAX and Database Operations</h1>
<a href="what_is_xmlhttprequest.html"><img alt="previous" border="0" src="../images/previous.gif" /></a>
<a href="ajax_security.html"><img alt="next" border="0" src="../images/next.gif" /></a>
<!-- AddThis Bookmark Button BEGIN -->
<a href="http://www.addthis.com/bookmark.php" rel="nofollow" onclick="addthis_url   = location.href; addthis_title = document.title; return addthis_click(this);" target="_blank"><img src="../images/add-this.gif" border="0" alt="AddThis Social Bookmark Button" /></a> <script type="text/javascript">var addthis_pub = 'tutorialspoint';</script><script type="text/javascript" src="http://s9.addthis.com/js/widget.php?v=10"></script>
<!-- AddThis Bookmark Button END -->
<br />
<br />
<hr/><div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "image";
google_ad_channel = "";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<hr />
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top">
<p>To clearly illustrate how easy it is to access information from a database using Ajax, we are going to build MySQL queries on the fly and display the results on "ajax.html". But before we proceed, lets do ground work. Create a table using the following command.
</p>
<p><strong>NOTE: </strong>We are asuing you have sufficient privilege to perform following MySQL operations</p>
<pre class="verbatim">
CREATE TABLE `ajax_example` (
  `name` varchar(50) NOT NULL,
  `age` int(11) NOT NULL,
  `sex` varchar(1) NOT NULL,
  `wpm` int(11) NOT NULL,
  PRIMARY KEY  (`name`)
) 
</pre>
<p>Now dump the following data into this table using the following SQL statements</p>
<pre class="verbatim">
INSERT INTO `ajax_example` VALUES ('Jerry', 120, 'm', 20);
INSERT INTO `ajax_example` VALUES ('Regis', 75, 'm', 44);
INSERT INTO `ajax_example` VALUES ('Frank', 45, 'm', 87);
INSERT INTO `ajax_example` VALUES ('Jill', 22, 'f', 72);
INSERT INTO `ajax_example` VALUES ('Tracy', 27, 'f', 0);
INSERT INTO `ajax_example` VALUES ('Julie', 35, 'f', 90);
</pre>
<hr>
<h2>Client Side HTML file</h2>
<p>Now lets have our client side HTML file which is ajax.html and it will have following code</p>

<pre class="verbatim">
&lt;html&gt;
&lt;body&gt;
&lt;script language="javascript" type="text/javascript"&gt;
&lt;!-- 
<font color='red'>//Browser Support Code</font>
function ajaxFunction(){
 var ajaxRequest;  // The variable that makes Ajax possible!
	
 try{
   // Opera 8.0+, Firefox, Safari
   ajaxRequest = new XMLHttpRequest();
 }catch (e){
   // Internet Explorer Browsers
   try{
      ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
   }catch (e) {
      try{
         ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
      }catch (e){
         // Something went wrong
         alert("Your browser broke!");
         return false;
      }
   }
 }
 // Create a function that will receive data 
 // sent from the server and will update
 // div section in the same page.
 ajaxRequest.onreadystatechange = function(){
   if(ajaxRequest.readyState == 4){
      var ajaxDisplay = document.getElementById('ajaxDiv');
      ajaxDisplay.value = ajaxRequest.responseText;
   }
 }
 // Now get the value from user and pass it to
 // server script.
 var age = document.getElementById('age').value;
 var wpm = document.getElementById('wpm').value;
 var sex = document.getElementById('sex').value;
 var queryString = "?age=" + age ;
 queryString +=  "&wpm=" + wpm + "&sex=" + sex;
 ajaxRequest.open("GET", "ajax-example.php" + 
                              queryString, true);
 ajaxRequest.send(null); 
}
<font color='red'>//--&gt;</font>
&lt;/script&gt;
&lt;form name='myForm'&gt;
Max Age: &lt;input type='text' id='age' /&gt; &lt;br /&gt;
Max WPM: &lt;input type='text' id='wpm' /&gt;
&lt;br /&gt;
Sex: &lt;select id='sex'&gt;
&lt;option value="m"&gt;m&lt;/option&gt;
&lt;option value="f"&gt;f&lt;/option&gt;
&lt;/select&gt;
&lt;input type='button' onclick='ajaxFunction()' 
                              value='Query MySQL'/&gt;
&lt;/form&gt;
&lt;div id='ajaxDiv'&gt;Your result will display here&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;

</pre>
<p><strong>NOTE: </strong> The way of passing variables in the Query is according to HTTP standard and the have formA</p>
<pre class="verbatim">
URL?variable1=value1;&variable2=value2;
</pre>
<p>Now the above code will give you a screen as given below</p>
<hr>
<p><b>NOTE:</b> This is dummy screen and would not work</p>
<script language="javascript" type="text/javascript">
<!-- 
//Browser Support Code
function ajaxFunction(){
 var ajaxRequest;  // The variable that makes Ajax possible!
	
 try{
   // Opera 8.0+, Firefox, Safari
   ajaxRequest = new XMLHttpRequest();
 }catch (e){
   // Internet Explorer Browsers
   try{
      ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
   }catch (e) {
      try{
         ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
      }catch (e){
         // Something went wrong
         alert("Your browser broke!");
         return false;
      }
   }
 }
 // Create a function that will receive data 
 // sent from the server and will update
 // div section in the same page.
 ajaxRequest.onreadystatechange = function(){
   if(ajaxRequest.readyState == 4){
      var ajaxDisplay = document.getElementById('ajaxDiv');
      ajaxDisplay.innerHTML = ajaxRequest.responseText;
   }
 }

 // Now get the value from user and pass it to
 // server script.
 var age = document.getElementById('age').value;
 var wpm = document.getElementById('wpm').value;
 var sex = document.getElementById('sex').value;
 var queryString = "?age=" + age ;
 queryString +=  "&wpm=" + wpm + "&sex=" + sex;
 ajaxRequest.open("GET", "ajax-example.html" + 
                              queryString, true);
 ajaxRequest.send(null); 
}
//-->
</script>

<form name='myForm0'>
Max Age:&nbsp; <input type='text' id='age0' /><br /><br>

Max WPM: <input type='text' id='wpm0' /><br>
<br />
Sex: <select id='sex0'>
<option value="m">m</option>
<option value="f">f</option>
</select>
<input type='button' onclick='' value='Query MySQL' />
</form>
<font color="red">
<div id='ajaxDiv0'>Your result will display here</div>
</font>
<hr>

<h2>Server Side PHP file</h2>
<p>So now your client side script is ready. Now we have to write our server side script which will fetch age, wpm and sex from the database and will send it back to the client. Put the following code into "ajax-example.php" file</p>
<pre class="verbatim">
&lt;?php
$dbhost = "localhost";
$dbuser = "dbusername";
$dbpass = "dbpassword";
$dbname = "dbname";
	//Connect to MySQL Server
mysql_connect($dbhost, $dbuser, $dbpass);
	//Select Database
mysql_select_db($dbname) or die(mysql_error());
	// Retrieve data from Query String
$age = $_GET['age'];
$sex = $_GET['sex'];
$wpm = $_GET['wpm'];
	// Escape User Input to help prevent SQL Injection
$age = mysql_real_escape_string($age);
$sex = mysql_real_escape_string($sex);
$wpm = mysql_real_escape_string($wpm);
	//build query
$query = "SELECT * FROM ajax_example WHERE sex = '$sex'";
if(is_numeric($age))
	$query .= " AND age &lt;= $age";
if(is_numeric($wpm))
	$query .= " AND wpm &lt;= $wpm";
	//Execute query
$qry_result = mysql_query($query) or die(mysql_error());

	//Build Result String
$display_string = "&lt;table&gt;";
$display_string .= "&lt;tr&gt;";
$display_string .= "&lt;th&gt;Name&lt;/th&gt;";
$display_string .= "&lt;th&gt;Age&lt;/th&gt;";
$display_string .= "&lt;th&gt;Sex&lt;/th&gt;";
$display_string .= "&lt;th&gt;WPM&lt;/th&gt;";
$display_string .= "&lt;/tr&gt;";

// Insert a new row in the table for each person returned
while($row = mysql_fetch_array($qry_result)){
	$display_string .= "&lt;tr&gt;";
	$display_string .= "&lt;td&gt;$row[name]&lt;/td&gt;";
	$display_string .= "&lt;td&gt;$row[age]&lt;/td&gt;";
	$display_string .= "&lt;td&gt;$row[sex]&lt;/td&gt;";
	$display_string .= "&lt;td&gt;$row[wpm]&lt;/td&gt;";
	$display_string .= "&lt;/tr&gt;";
	
}
echo "Query: " . $query . "&lt;br /&gt;";
$display_string .= "&lt;/table&gt;";
echo $display_string;
?&gt;

</pre>
<hr>
<p>Now try by entering a valid value (For example 120) in <i>Max Age</i> or any other box and then click Query MySQL button.</p>
<form name='myForm'>
Max Age:&nbsp; <input type='text' id='age' /><br /><br>
Max WPM: <input type='text' id='wpm' /><br>
<br />
Sex: <select id='sex'>
<option value="m">m</option>
<option value="f">f</option>
</select>
<input type='button' onclick='ajaxFunction()' value='Query MySQL' />
</form>
<font color="red">
<div id='ajaxDiv'>Your result will display here</div>
</font>
<hr>
<p>If you have successfully completed this lesson then you know how to use MySQL, PHP, HTML, and Javascript in tandem to write Ajax applications.</p>
</td>
</tr></table>
<br />
<hr />
<a href="what_is_xmlhttprequest.html"><img alt="previous" border="0" src="../images/previous.gif" /></a>
<a href="ajax_security.html"><img alt="next" border="0" src="../images/next.gif" /></a>
<a href='../cgi-bin/printversionbd36.html?tutorial=ajax&amp;file=ajax_database.htm' target="_blank">
<img src="../images/print.gif" alt="Printer Friendly" border="0" /></a>
<br />
<hr />
<!-- PRINTING ENDS HERE -->
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 336;
google_ad_height = 280;
google_ad_format = "336x280_as";
google_ad_type = "text_image";
google_ad_channel ="9030538898";
google_color_border="ffffff";
google_color_link="900b09";
google_color_url="000000";
google_color_text="000000";
//--></script>
<script type="text/javascript" src="../../pagead2.googlesyndication.com/pagead/show_ads.js"></script>
</td></tr>
</table>
</td>
<td class="right" align="center" valign="top">
<br /><br />
<table width="100%" cellpadding="0" cellspacing="0">
<tr valign="middle">
<td  class="top" style="border:0px;">
&nbsp;&nbsp;
</td>
</tr>
</table>
<table class="right"  cellpadding="0" cellspacing="0">
<tr>
<td align="center" class="right">
<p>
<u>Advertisements</u>
</p>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<br /><br /></td></tr></table>
</td></tr></table>
</center>
</body>

<!-- Mirrored from www.tutorialspoint.com/ajax/ajax_database.htm by HTTrack Website Copier/3.x [XR&CO'2010], Mon, 15 Apr 2013 05:01:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
</html>
