<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from www.tutorialspoint.com/asp.net/asp.net_data_sources.htm by HTTrack Website Copier/3.x [XR&CO'2010], Mon, 15 Apr 2013 05:01:08 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<title>ASP.NET - Data Source Controls</title>
<link rel="shortcut icon" href="../favicon.png" type="image/x-icon" />
<meta name="Keywords" content="Free, ASP.NET, Tutorial, Reference, Manual, Guide, Beginners,Event Handling, Life Cycle, ADO.NET, AJAX control,Web Services,Add Rotator, Panel, control, LINQ, Database Access, Security, Debugging, Error, Handling, Configuration, Deployment." />
<meta name="description" content="ASP.NET Data Source Controls - Free ASP.NET Tutorials, Reference Manual, and Quick Guide for Beginners. Learn ASP.NET starting from Environment Setup, Basic Controls, Directives, Event Handling, Life Cycle, ADO.NET, AJAX control,Web Services,Add Rotator, Panel control, LINQ, Database Access, Security, Debugging, Error Handling, Configuration and Deployment." />
<meta http-equiv="pragma" content="no-cache" />
<meta http-equiv="cache-control" content="no-cache" />
<base  />
<link rel="stylesheet" type="text/css" href="../tp.css" />
<script src="../../www.google-analytics.com/urchin.js" type="text/javascript"> 
</script>
<script type="text/javascript"> 
_uacct = "UA-232293-6";
urchinTracker();
</script>
</head>
<body>
<center>
<a name="top"></a>
<table border="0" class="main" cellpadding="2" cellspacing="0">
<tr>
<td class="content" valign="top" align="left">
<a href="../index-2.html"><img src="../images/tp-logo.gif" border="0"  alt="Tutorials Point" /></a>
<br />
<br />
<div  class="search">
<!-- SiteSearch Google -->
<form method="get" action="http://www.google.com/custom" target="google_window">
<table border="0">
<tr><td nowrap="nowrap" valign="top" align="center" height="32">
<a href="http://www.google.com/">
<img src="../../www.google.com/logos/Logo_25wht.gif" border="0" alt="Google" align="middle"></img></a>
</td>
</tr>
<tr>
<td nowrap="nowrap">
<input type="hidden" name="domains" value="www.tutorialspoint.com"></input>
<input type="text" name="q" size="20" maxlength="255" value=""></input>
<input type="submit" name="sa" style="width:20px;font-weight:bold" value="..."></input>
</td></tr>
<tr>
<td nowrap="nowrap">
<table>
<tr>
<td>
<input type="radio" name="sitesearch" value="" checked="checked"></input>
<font size="-1" color="#000000">Web</font>
</td>
<td>
<input type="radio" name="sitesearch" value="www.tutorialspoint.com"></input>
<font size="-1" color="#000000">This Site</font>
</td>
</tr>
</table>
<input type="hidden" name="client" value="pub-7133395778201029"></input>
<input type="hidden" name="forid" value="1"></input>
<input type="hidden" name="ie" value="ISO-8859-1"></input>
<input type="hidden" name="oe" value="ISO-8859-1"></input>
<input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:336699;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;FORID:1"></input>
<input type="hidden" name="hl" value="en"></input>
</td></tr></table>
</form>
<!-- SiteSearch Google -->
</div>
<br />
&nbsp;&nbsp;<b>ASP.NET Tutorial</b>
<div  class="left">
<ul class="menu">
<li><a class="left" target="_top" href="index.html">ASP.NET -  Home</a></li>
<li><a class="left" target="_top" href="asp.net_introduction.html">ASP.NET -  Introduction</a></li>
<li><a class="left" target="_top" href="asp.net_environment_setup.html">ASP.NET -  Environment</a></li>
<li><a class="left" target="_top" href="asp.net_life_cycle.html">ASP.NET -  Life Cycle</a></li>
<li><a class="left" target="_top" href="asp.net_first_example.html">ASP.NET -  First Example</a></li>
<li><a class="left" target="_top" href="asp.net_event_handling.html">ASP.NET -  Event Handling</a></li>
<li><a class="left" target="_top" href="asp.net_server_side.html">ASP.NET -  Server Side</a></li>
<li><a class="left" target="_top" href="asp.net_server_controls.html">ASP.NET -  Server Controls</a></li>
<li><a class="left" target="_top" href="asp.net_html_server.html">ASP.NET -  HTML Server</a></li>
<li><a class="left" target="_top" href="asp.net_client_side.html">ASP.NET -  Client Side</a></li>
<li><a class="left" target="_top" href="asp.net_basic_controls.html">ASP.NET -  Basic Controls</a></li>
<li><a class="left" target="_top" href="asp.net_directives.html">ASP.NET -  Directives</a></li>
<li><a class="left" target="_top" href="asp.net_managing_state.html">ASP.NET -  Managing State</a></li>
<li><a class="left" target="_top" href="asp.net_validators.html">ASP.NET -  Validators</a></li>
<li><a class="left" target="_top" href="asp.net_database_access.html">ASP.NET -  Database Access</a></li>
<li><a class="left" target="_top" href="asp.net_ado_net.html">ASP.NET -  ADO.net</a></li>
<li><a class="left" target="_top" href="asp.net_file_uploading.html">ASP.NET -  File Uploading</a></li>
<li><a class="left" target="_top" href="asp.net_ad_rotator.html">ASP.NET -  Ad Rotator</a></li>
<li><a class="left" target="_top" href="asp.net_calenders.html">ASP.NET -  Calendars</a></li>
<li><a class="left" target="_top" href="asp.net_multi_views.html">ASP.NET -  Multi Views</a></li>
<li><a class="left" target="_top" href="asp.net_panel_controls.html">ASP.NET -  Panel Controls</a></li>
<li><a class="left" target="_top" href="asp.net_ajax_control.html">ASP.NET -  AJAX Control</a></li>
<li><a class="left" target="_top" href="asp.net_data_sources.html"><b>ASP.NET -  Data Sources</b></a></li>
<li><a class="left" target="_top" href="asp.net_data_binding.html">ASP.NET -  Data Binding</a></li>
<li><a class="left" target="_top" href="asp.net_custom_controls.html">ASP.NET -  Custom Controls</a></li>
<li><a class="left" target="_top" href="asp.net_personalization.html">ASP.NET -  Personalization</a></li>
<li><a class="left" target="_top" href="asp.net_error_handling.html">ASP.NET -  Error Handling</a></li>
<li><a class="left" target="_top" href="asp.net_debugging.html">ASP.NET -  Debugging</a></li>
<li><a class="left" target="_top" href="asp.net_linq.html">ASP.NET -  LINQ </a></li>
<li><a class="left" target="_top" href="asp.net_security.html">ASP.NET -  Security</a></li>
<li><a class="left" target="_top" href="asp.net_data_caching.html">ASP.NET -  Data Caching </a></li>
<li><a class="left" target="_top" href="asp.net_web_services.html">ASP.NET -  Web Services</a></li>
<li><a class="left" target="_top" href="asp.net_multi_threading.html">ASP.NET -  Multi Threading</a></li>
<li><a class="left" target="_top" href="asp.net_configuration.html">ASP.NET -  Configuration</a></li>
<li><a class="left" target="_top" href="asp.net_deployment.html">ASP.NET -  Deployment</a></li>
</ul>
</div>
<br />
&nbsp;&nbsp;<b>ASP.NET Quick Guide</b>
<div  class="left">
<ul class="menu">
<li><a class="left" target="_top" href="asp.net_quick_guide.html">ASP.NET - Quick Guide</a></li>
</ul>
</div>
<br />
&nbsp;&nbsp;<b>ASP.NET Useful Resources</b>
<div  class="left">
<ul class="menu">
<li><a class="left" target="_top" href="asp.net_useful_resources.html">ASP.NET - Useful Resources</a></li>
</ul>
</div>
<br />
&nbsp;&nbsp;<b>Selected Reading</b>
<div  class="left">
<ul class="menu">
<li><a class="left" target="_top" href="../computer_glossary.html">Computer Glossary</a></li>
<li><a class="left" target="_top" href="../computer_whoiswho.html">Who is Who</a></li>
</ul>
</div>
<br /><br />
<small>&copy; 2013 TutorialsPoint.COM </small>
</td>
<td valign="top">
<br /><br />
<table cellpadding="0" cellspacing="0">
<tr valign="middle">
<td  style="width:20px;"></td>
<td  class="top">
&nbsp;&nbsp;<a class="top" href="../index-2.html">Home</a>&nbsp;&nbsp;
</td>
<td  style="width:20px;"></td>
<td  class="top">
&nbsp;&nbsp;<a class="top" href="../references.html">References</a>&nbsp;&nbsp;
</td>
<td  style="width:20px;"></td>
<td  class="top">
&nbsp;&nbsp;<a class="top" href="../forums/index.html">Discussion Forums</a>&nbsp;&nbsp;
</td>
<td  style="width:20px;"></td>
<td  class="top">
&nbsp;&nbsp;<a class="top" href="../about/index.html">About TP</a>&nbsp;&nbsp;
</td>
</tr>
</table>
<table class="middle" cellpadding="5" cellspacing="0">
<tr>
<td>
<!-- PRINTING STARTS HERE -->
<h1>ASP.NET -  Data Sources Controls</h1>
<hr />
<a href="asp.net_ajax_control.html"><img alt="previous" border="0" src="../images/previous.gif" /></a>
<a href="asp.net_data_binding.html"><img alt="next" border="0" src="../images/next.gif" /></a>
<!-- AddThis Bookmark Button BEGIN -->
<a href="http://www.addthis.com/bookmark.php" rel="nofollow" onclick="addthis_url   = location.href; addthis_title = document.title; return addthis_click(this);" target="_blank"><img src="../images/add-this.gif" border="0" alt="AddThis Social Bookmark Button" /></a> <script type="text/javascript">var addthis_pub = 'tutorialspoint';</script><script type="text/javascript" src="http://s9.addthis.com/js/widget.php?v=10"></script>
<!-- AddThis Bookmark Button END -->
<br />
<br />
<hr/><div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "image";
google_ad_channel = "";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.js"> 
</script>
<hr />
<p>A data source control interacts with the data-bound controls and hides the complex data binding processes. These are the tools that provide data to the data bound controls and support execution of operations like insertions, deletions, sorting and updates.</p>
<p>Each data source control wraps a particular data provider-relational databases, XML documents or custom classes and helps in:</p>
<ul>
<li><p>Managing connection.</p></li>
<li><p>Selection of data</p></li>
<li><p>Managing presentation aspects like paging, caching etc.</p></li>
<li><p>Manipulation of data</p></li>
</ul>
<p>There are many data source controls available in ASP.Net for accessing data from SQL Server, from ODBC or OLE DB servers, from XML files and from business objects.</p>
<p>Based on type of data, these controls could be divided into two categories: hierarchical data source controls and table-based data source controls.</p>
<p>The data source controls used for hierarchical data are:</p>
<ul>
<li><p><b>XMLDataSource</b>-allows binding to XML files and strings with or without schema information</p></li>
<li><p><b>SiteMapDataSource</b>-allows binding to a provider that supplies site map information</p></li>
</ul>
<p>The data source controls used for tabular data are:</p>
<table class="src" border="1" cellpadding="5" cellspacing="0" width="100%">
<tr><th width="30%">Data source controls</th><th>Description</th></tr>
<tr><td>SqlDataSource</td><td>represents a connection to an ADO.Net data provider that returns SQL data, including data sources accessible via OLEDB and QDBC</td></tr>
<tr><td>ObjectDataSource</td><td>allows binding to a custom .Net business object that returns data</td></tr>
<tr><td>LinqdataSource</td><td>allows binding to the results of a Linq-to-SQL query (supported by ASP.Net 3.5 only)</td></tr>
<tr><td>AccessDataSource</td><td>represents connection to a Microsoft Access database</td></tr>
</table>
<h1>The Data Source Views</h1>
<p>Data source views are objects of the DataSourceView class and represent a customized view of data for different data operations like sorting, filtering etc.</p>
<p>The DataSourceView class serves as the base class for all data source view classes, which define the capabilities of data source controls.</p>
<p>Following table provides the properties of the DataSourceView class:</p>
<table class="src" border="1" cellpadding="5" cellspacing="0" width="100%">
<tr><th width="30%">Properties</th><th>Description</th></tr>
<tr><td>CanDelete</td><td>Indicates whether deletion is allowed on the underlying data source.</td></tr>
<tr><td>CanInsert</td><td>Indicates whether insertion is allowed on the underlying data source.</td></tr>
<tr><td>CanPage </td><td>Indicates whether paging is allowed on the underlying data source.</td></tr>
<tr><td>CanRetrieveTotalRowCount</td><td>Indicates whether total row count information is available.</td></tr>
<tr><td>CanSort</td><td>Indicates whether the data could be sorted.</td></tr>
<tr><td>CanUpdate</td><td>Indicates whether updates are allowed on the underlying data source.</td></tr>
<tr><td>Events </td><td>Gets a list of event-handler delegates for the data source view.</td></tr>
<tr><td>Name</td><td>Name of the view.</td></tr>
</table>
<p>Following table provides the methods of the DataSourceView class:</p>
<table class="src" border="1" cellpadding="5" cellspacing="0" width="100%">
<tr><th width="30%">Methods</th><th>Description</th></tr>
<tr><td>CanExecute</td><td>Determines whether the specified command can be executed.</td></tr>
<tr><td>ExecuteCommand</td><td>Executes the specific command.</td></tr>
<tr><td>ExecuteDelete </td><td>Performs a delete operation on the list of data that the DataSourceView object represents.</td></tr>
<tr><td>ExecuteInsert</td><td>Performs an insert operation on the list of data that the DataSourceView object represents.</td></tr>
<tr><td>ExecuteSelect </td><td>Gets a list of data from the underlying data storage.</td></tr>
<tr><td>ExecuteUpdate</td><td>Performs an update operation on the list of data that the DataSourceView object represents.</td></tr>
<tr><td>Delete </td><td>Performs a delete operation on the data associated with the view.</td></tr>
<tr><td>Insert</td><td>Performs an insert operation on the data associated with the view.</td></tr>
<tr><td>Select </td><td>Returns the queried data.</td></tr>
<tr><td>Update</td><td>Performs an update operation on the data associated with the view.</td></tr>
<tr><td>OnDataSourceViewChanged</td><td>Raises the DataSourceViewChanged event.</td></tr>
<tr><td>RaiseUnsupportedCapabilitiesError</td><td>Called by the RaiseUnsupportedCapabilitiesError method to compare the capabilities requested for an ExecuteSelect operation against those that the view supports.</td></tr>
</table>
<h1>The SqlDataSource Control</h1>
<p>The SqlDataSource control represents a connection to a relational database such as SQL Server or Oracle database, or data accessible through OLEDB or Open Database Connectivity (ODBC). Connection to data is made through two important properties ConnectionString and ProviderName.</p>
<p>The following code snippet provides the basic syntax for the control:</p>
<table class="src" cellpadding="5">
<tr><td><pre>
&lt;asp:SqlDataSource runat="server" ID="MySqlSource"
ProviderName='&lt;%$ ConnectionStrings:LocalNWind.ProviderName  %&gt;'
ConnectionString='&lt;%$ ConnectionStrings:LocalNWind %&gt;'
SelectionCommand= "SELECT * FROM EMPLOYEES" /&gt;

&lt;asp:GridView ID="GridView1" runat="server" 
                             DataSourceID="MySqlSource"&gt;
</pre></td></tr>
</table>
<p>Configuring various data operations on the underlying data depends upon the various properties (property groups) of the data source control.</p>
<p>The following table provides the related sets of properties of the SqlDataSource control, which provides the programming interface of the control:</p>
<table class="src" border="1" cellpadding="5" cellspacing="0" width="100%">
<tr><th width="30%">Property Group</th><th>Description</th></tr>
<tr><td>DeleteCommand,<br />
DeleteParameters,<br />
DeleteCommandType
</td><td>Gets or sets the SQL statement, parameters and type for deleting rows in the underlying data.</td></tr>
<tr><td>FilterExpression,<br />
FilterParameters<br />
 </td><td>Gets or sets the data filtering string and parameters.</td></tr>
<tr><td>InsertCommand,<br />
InsertParameters,<br />
InsertCommandType
 </td><td>Gets or sets the SQL statement, parameters and type for inserting rows in the underlying database.</td></tr>
<tr><td>SelectCommand,<br />
SelectParameters,<br />
SelectCommandType
 </td><td>Gets or sets the SQL statement, parameters and type for retrieving rows from the underlying database.</td></tr>
<tr><td>SortParameterName </td><td>Gets or sets the name of an input parameter that the command's stored procedure will use to sort data</td></tr>
<tr><td>UpdateCommand,<br />
UpdateParameters,<br />
UpdateCommandType
 </td><td>Gets or sets the SQL statement, parameters and type for updating rows in the underlying data store.</td></tr>
</table>
<p>The following code snippet shows a data source control enabled for data manipulation:</p>
<table class="src" cellpadding="5">
<tr><td><pre>
&lt;asp:SqlDataSource runat="server" ID= "MySqlSource"
ProviderName='&lt;%$ ConnectionStrings:LocalNWind.ProviderName  %&gt;'
ConnectionString=' &lt;%$ ConnectionStrings:LocalNWind %&gt;'
SelectCommand= "SELECT * FROM EMPLOYEES"
UpdateCommand= "UPDATE EMPLOYEES SET LASTNAME=@lame"
DeleteCommand= "DELETE FROM EMPLOYEES WHERE EMPLOYEEID=@eid"
FilterExpression= "EMPLOYEEID &gt; 10"&gt;
.....
.....
&lt;/asp:SqlDataSource&gt;
</pre></td></tr>
</table>
<h1>The ObjectDataSource Control:</h1>
<p>The ObjectDataSource Control enables user-defined classes to associate the output of their methods to data bound controls. The programming interface of this class is almost same as the SqlDataSource control. </p>
<p>Following are two important aspects of binding business objects:</p>
<ul>
<li><p>The bindable class should have a default constructor, be stateless, and have methods that can be mapped to select, update, insert and delete semantics.</p></li>
<li><p>The object must update one item at a time, batch operations are not supported.</p></li>
</ul>
<p>Let us go directly to an example to work with this control. The student class is our class to be used with an object data source. This class has three properties: a student id, name and city. It has a default constructor and a GetStudents method to be used for retrieving data.</p>
<p>The student class:</p>
<table class="src" cellpadding="5">
<tr><td><pre>
public class Student
{
   public int StudentID { get; set; }
   public string Name { get; set; }
   public string City { get; set; }
   public Student()
   { }
   public DataSet GetStudents()
   {
      DataSet ds = new DataSet();
      DataTable dt = new DataTable("Students");
      dt.Columns.Add("StudentID", typeof(System.Int32));
      dt.Columns.Add("StudentName", typeof(System.String));
      dt.Columns.Add("StudentCity", typeof(System.String));
      dt.Rows.Add(new object[] { 1, "M. H. Kabir", "Calcutta" });
      dt.Rows.Add(new object[] { 2, "Ayan J. Sarkar", "Calcutta" });
      ds.Tables.Add(dt);
      return ds;
   }
}
</pre></td></tr>
</table>
<p>Take the following steps to bind the object with an object data source and retrieve data:</p>
<ul>
<li><p>Create a new web site. Add a class (Students.cs) to it by right clicking the project from the Solution Explorer, adding a class template and placing the above code in it.</p></li>
<li><p>Build the solution so that the application can use the reference to the class.</p></li>
<li><p>Place a object data source control in the web form.</p></li>
<li><p>Configure the data source by selecting the object.</p></li>
</ul>
<center>
<img src="../images/selecting_the_object.html" alt="selecting the object" />
</center>
<ul>
<li><p>Select a data method(s) for different operations on data. In this example, there is only one method.</p></li>
</ul>
<center>
<img src="../images/select_data_method.html" alt="Select a data method" />
</center>
<ul>
<li><p>Place a data bound control like grid view on the page and select the object data source as its underlying data source</p></li>
</ul>
<center>
<img src="../images/data_bound_control.html" alt="Data Bound Control" />
</center>
<ul>
<li><p>At this stage, the design view should look like the following:</p></li>
</ul>
<center>
<img src="../images/object_data_source.html" alt="Object Data Source" />
</center>
<ul>
<li><p>Run the project, it retrieves the hard coded tuples from the students class.</p></li>
</ul>
<center>
<img src="../images/object_data_result.html" alt="Object Data Result" />
</center>
<h1>The AccessDataSource Control:</h1>
<p>The AccessDataSource control represents a connection to an Access database. It is based on the SqlDataSource control and provides simpler programming interface. The following code snippet provides the basic syntax for the data source:</p>
<table class="src" cellpadding="5">
<tr><td><pre>
&lt;asp:AccessDataSource ID="AccessDataSource1" 
            runat="server" 
            DataFile="~/App_Data/ASPDotNetStepByStep.mdb" 
            SelectCommand="SELECT * FROM [DotNetReferences]"&gt;
&lt;/asp:AccessDataSource&gt;
</pre></td></tr>
</table>
<p>The AccessDataSource control opens the database in read-only mode.  However, it can also be used for performing insert, update or delete operations. This is done using the ADO.Net commands and parameter collection.</p>
<p>Updates are problematic for Access databases from within an ASP.Net application because an Access database is a plain file and the default account of the ASP.Net application might not have the permission to write to the database file. </p>
<br />
<hr />
<a href="asp.net_ajax_control.html"><img alt="previous" border="0" src="../images/previous.gif" /></a>
<a href="asp.net_data_binding.html"><img alt="next" border="0" src="../images/next.gif" /></a>
<a href='../cgi-bin/printversionce96.html?tutorial=asp.net&amp;file=asp.net_data_sources.htm' target="_blank">
<img src="../images/print.gif" alt="Printer Friendly" border="0" /></a>
<br />
<hr />
<!-- PRINTING ENDS HERE -->
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 336;
google_ad_height = 280;
google_ad_format = "336x280_as";
google_ad_type = "text_image";
google_ad_channel ="9030538898";
google_color_border="ffffff";
google_color_link="900b09";
google_color_url="000000";
google_color_text="000000";
//--></script>
<script type="text/javascript" src="../../pagead2.googlesyndication.com/pagead/show_ads.js"></script>
</td></tr>
</table>
</td>
<td class="right" align="center" valign="top">
<br /><br />
<table width="100%" cellpadding="0" cellspacing="0">
<tr valign="middle">
<td  class="top" style="border:0px;">
&nbsp;&nbsp;
</td>
</tr>
</table>
<table class="right"  cellpadding="0" cellspacing="0">
<tr>
<td align="center" class="right">
<p>
<u>Advertisements</u>
</p>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<br /><br /></td></tr></table>
</td></tr></table>
</center>
</body>

<!-- Mirrored from www.tutorialspoint.com/asp.net/asp.net_data_sources.htm by HTTrack Website Copier/3.x [XR&CO'2010], Mon, 15 Apr 2013 05:01:08 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
</html>
