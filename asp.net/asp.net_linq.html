<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from www.tutorialspoint.com/asp.net/asp.net_linq.htm by HTTrack Website Copier/3.x [XR&CO'2010], Mon, 15 Apr 2013 05:01:08 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<title>LINQ Tutorial</title>
<link rel="shortcut icon" href="../favicon.png" type="image/x-icon" />
<meta name="Keywords" content="LINQ, Free, ASP.NET, Tutorial, Reference, Manual, Guide, Beginners,Event Handling, Life Cycle, ADO.NET, AJAX control,Web Services,Add Rotator, Panel, control, LINQ, Database Access, Security, Debugging, Error, Handling, Configuration, Deployment." />
<meta name="description" content="LINQ Tutorial  - Free ASP.NET Tutorials, Reference Manual, and Quick Guide for Beginners. Learn ASP.NET starting from Environment Setup, Basic Controls, Directives, Event Handling, Life Cycle, ADO.NET, AJAX control,Web Services,Add Rotator, Panel control, LINQ, Database Access, Security, Debugging, Error Handling, Configuration and Deployment." />
<meta http-equiv="pragma" content="no-cache" />
<meta http-equiv="cache-control" content="no-cache" />
<base  />
<link rel="stylesheet" type="text/css" href="../tp.css" />
<script src="../../www.google-analytics.com/urchin.js" type="text/javascript"> 
</script>
<script type="text/javascript"> 
_uacct = "UA-232293-6";
urchinTracker();
</script>
</head>
<body>
<center>
<a name="top"></a>
<table border="0" class="main" cellpadding="2" cellspacing="0">
<tr>
<td class="content" valign="top" align="left">
<a href="../index-2.html"><img src="../images/tp-logo.gif" border="0"  alt="Tutorials Point" /></a>
<br />
<br />
<div  class="search">
<!-- SiteSearch Google -->
<form method="get" action="http://www.google.com/custom" target="google_window">
<table border="0">
<tr><td nowrap="nowrap" valign="top" align="center" height="32">
<a href="http://www.google.com/">
<img src="../../www.google.com/logos/Logo_25wht.gif" border="0" alt="Google" align="middle"></img></a>
</td>
</tr>
<tr>
<td nowrap="nowrap">
<input type="hidden" name="domains" value="www.tutorialspoint.com"></input>
<input type="text" name="q" size="20" maxlength="255" value=""></input>
<input type="submit" name="sa" style="width:20px;font-weight:bold" value="..."></input>
</td></tr>
<tr>
<td nowrap="nowrap">
<table>
<tr>
<td>
<input type="radio" name="sitesearch" value="" checked="checked"></input>
<font size="-1" color="#000000">Web</font>
</td>
<td>
<input type="radio" name="sitesearch" value="www.tutorialspoint.com"></input>
<font size="-1" color="#000000">This Site</font>
</td>
</tr>
</table>
<input type="hidden" name="client" value="pub-7133395778201029"></input>
<input type="hidden" name="forid" value="1"></input>
<input type="hidden" name="ie" value="ISO-8859-1"></input>
<input type="hidden" name="oe" value="ISO-8859-1"></input>
<input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:336699;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;FORID:1"></input>
<input type="hidden" name="hl" value="en"></input>
</td></tr></table>
</form>
<!-- SiteSearch Google -->
</div>
<br />
&nbsp;&nbsp;<b>ASP.NET Tutorial</b>
<div  class="left">
<ul class="menu">
<li><a class="left" target="_top" href="index.html">ASP.NET -  Home</a></li>
<li><a class="left" target="_top" href="asp.net_introduction.html">ASP.NET -  Introduction</a></li>
<li><a class="left" target="_top" href="asp.net_environment_setup.html">ASP.NET -  Environment</a></li>
<li><a class="left" target="_top" href="asp.net_life_cycle.html">ASP.NET -  Life Cycle</a></li>
<li><a class="left" target="_top" href="asp.net_first_example.html">ASP.NET -  First Example</a></li>
<li><a class="left" target="_top" href="asp.net_event_handling.html">ASP.NET -  Event Handling</a></li>
<li><a class="left" target="_top" href="asp.net_server_side.html">ASP.NET -  Server Side</a></li>
<li><a class="left" target="_top" href="asp.net_server_controls.html">ASP.NET -  Server Controls</a></li>
<li><a class="left" target="_top" href="asp.net_html_server.html">ASP.NET -  HTML Server</a></li>
<li><a class="left" target="_top" href="asp.net_client_side.html">ASP.NET -  Client Side</a></li>
<li><a class="left" target="_top" href="asp.net_basic_controls.html">ASP.NET -  Basic Controls</a></li>
<li><a class="left" target="_top" href="asp.net_directives.html">ASP.NET -  Directives</a></li>
<li><a class="left" target="_top" href="asp.net_managing_state.html">ASP.NET -  Managing State</a></li>
<li><a class="left" target="_top" href="asp.net_validators.html">ASP.NET -  Validators</a></li>
<li><a class="left" target="_top" href="asp.net_database_access.html">ASP.NET -  Database Access</a></li>
<li><a class="left" target="_top" href="asp.net_ado_net.html">ASP.NET -  ADO.net</a></li>
<li><a class="left" target="_top" href="asp.net_file_uploading.html">ASP.NET -  File Uploading</a></li>
<li><a class="left" target="_top" href="asp.net_ad_rotator.html">ASP.NET -  Ad Rotator</a></li>
<li><a class="left" target="_top" href="asp.net_calenders.html">ASP.NET -  Calendars</a></li>
<li><a class="left" target="_top" href="asp.net_multi_views.html">ASP.NET -  Multi Views</a></li>
<li><a class="left" target="_top" href="asp.net_panel_controls.html">ASP.NET -  Panel Controls</a></li>
<li><a class="left" target="_top" href="asp.net_ajax_control.html">ASP.NET -  AJAX Control</a></li>
<li><a class="left" target="_top" href="asp.net_data_sources.html">ASP.NET -  Data Sources</a></li>
<li><a class="left" target="_top" href="asp.net_data_binding.html">ASP.NET -  Data Binding</a></li>
<li><a class="left" target="_top" href="asp.net_custom_controls.html">ASP.NET -  Custom Controls</a></li>
<li><a class="left" target="_top" href="asp.net_personalization.html">ASP.NET -  Personalization</a></li>
<li><a class="left" target="_top" href="asp.net_error_handling.html">ASP.NET -  Error Handling</a></li>
<li><a class="left" target="_top" href="asp.net_debugging.html">ASP.NET -  Debugging</a></li>
<li><a class="left" target="_top" href="asp.net_linq.html"><b>ASP.NET -  LINQ</b></a></li>
<li><a class="left" target="_top" href="asp.net_security.html">ASP.NET -  Security</a></li>
<li><a class="left" target="_top" href="asp.net_data_caching.html">ASP.NET -  Data Caching </a></li>
<li><a class="left" target="_top" href="asp.net_web_services.html">ASP.NET -  Web Services</a></li>
<li><a class="left" target="_top" href="asp.net_multi_threading.html">ASP.NET -  Multi Threading</a></li>
<li><a class="left" target="_top" href="asp.net_configuration.html">ASP.NET -  Configuration</a></li>
<li><a class="left" target="_top" href="asp.net_deployment.html">ASP.NET -  Deployment</a></li>
</ul>
</div>
<br />
&nbsp;&nbsp;<b>ASP.NET Quick Guide</b>
<div  class="left">
<ul class="menu">
<li><a class="left" target="_top" href="asp.net_quick_guide.html">ASP.NET - Quick Guide</a></li>
</ul>
</div>
<br />
&nbsp;&nbsp;<b>ASP.NET Useful Resources</b>
<div  class="left">
<ul class="menu">
<li><a class="left" target="_top" href="asp.net_useful_resources.html">ASP.NET - Useful Resources</a></li>
</ul>
</div>
<br />
&nbsp;&nbsp;<b>Selected Reading</b>
<div  class="left">
<ul class="menu">
<li><a class="left" target="_top" href="../computer_glossary.html">Computer Glossary</a></li>
<li><a class="left" target="_top" href="../computer_whoiswho.html">Who is Who</a></li>
</ul>
</div>
<br /><br />
<small>&copy; 2013 TutorialsPoint.COM </small>
</td>
<td valign="top">
<br /><br />
<table cellpadding="0" cellspacing="0">
<tr valign="middle">
<td  style="width:20px;"></td>
<td  class="top">
&nbsp;&nbsp;<a class="top" href="../index-2.html">Home</a>&nbsp;&nbsp;
</td>
<td  style="width:20px;"></td>
<td  class="top">
&nbsp;&nbsp;<a class="top" href="../references.html">References</a>&nbsp;&nbsp;
</td>
<td  style="width:20px;"></td>
<td  class="top">
&nbsp;&nbsp;<a class="top" href="../forums/index.html">Discussion Forums</a>&nbsp;&nbsp;
</td>
<td  style="width:20px;"></td>
<td  class="top">
&nbsp;&nbsp;<a class="top" href="../about/index.html">About TP</a>&nbsp;&nbsp;
</td>
</tr>
</table>
<table class="middle" cellpadding="5" cellspacing="0">
<tr>
<td>
<!-- PRINTING STARTS HERE -->
<h1>ASP.NET -  LINQ</h1>
<hr />
<a href="asp.net_debugging.html"><img alt="previous" border="0" src="../images/previous.gif" /></a>
<a href="asp.net_security.html"><img alt="next" border="0" src="../images/next.gif" /></a>
<!-- AddThis Bookmark Button BEGIN -->
<a href="http://www.addthis.com/bookmark.php" rel="nofollow" onclick="addthis_url   = location.href; addthis_title = document.title; return addthis_click(this);" target="_blank"><img src="../images/add-this.gif" border="0" alt="AddThis Social Bookmark Button" /></a> <script type="text/javascript">var addthis_pub = 'tutorialspoint';</script><script type="text/javascript" src="http://s9.addthis.com/js/widget.php?v=10"></script>
<!-- AddThis Bookmark Button END -->
<br />
<br />
<hr/><div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "image";
google_ad_channel = "";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.js"> 
</script>
<hr />
<p>Most applications are data-centric and most of these data repositories are however, relational databases. Over the years designers and developers have designed applications based on object models.</p>
<p>These objects were responsible for connecting to the data access components - called the data access layer (DAL). There are however, two things to consider:</p>
<ul>
<li><p>All the data needed in an application are not stored in the same source. The source could be a relation database, some business objects, XML file, or on web services.</p></li>
<li><p>Accessing in-memory object is simpler and less expensive than accessing data from a database or XML file. </p></li>
<li><p>The data accessed are not used directly, but needs to be sorted, ordered, grouped, altered etc. </p></li>
</ul>
<p>So if there is one tool that makes all kinds of data access easy, that allows joining data from such disparate data sources and perform standard data processing operations, in few lines of codes, it would be of great help. </p>
<p>LINQ or Language-Integrated Query is such a tool. LINQ is set of extensions to the .Net Framework 3.5 and its managed languages that sets the query as an object. It defines a common syntax and a programming model to query different types of data using a common language.</p>
<p>The relational operators like Select, Project, Join, Group, Partition, Set operations etc., are implemented in LINQ and the C# and VB compilers in the .Net framework 3.5, which support the LINQ syntax makes it possible to work with a configured data store without resorting to ADO.Net.</p>
<p>For example querying the Customers table in the Northwind database, using LINQ query in C#, the code would be:</p>
<table class="src" cellpadding="5">
<tr><td><pre>
var data = from c in dataContext.Customers
where c.Country == "Spain"
select c;
</pre></td></tr>
</table>
<p>Where:</p>
<ul>
<li><p>The 'from' keyword logically loops through the contents of the collection.</p></li>
<li><p>The expression with the 'where' keyword is evaluated for each object in the collection.</p></li>
<li><p>The 'select' statement selects the evaluated object to add to the list being returned.</p></li>
<li><p>The 'var' keyword is for variable declaration. Since the exact type of the returned object is not known, it indicates that the information will be inferred dynamically.</p></li>
</ul>
<p>LINQ query can be applied to any data-bearing class that inherits from IEnumerable&lt;T&gt;, here T is any data type, for example List&lt;Book&gt;.</p>
<p>Let us look at an example to understand the concept. The example uses the following class: Books.cs</p>
<table class="src" cellpadding="5">
<tr><td><pre>
public class Books
{
   public string ID {get; set;}
   public string Title { get; set; }
   public decimal Price { get; set; }
   public DateTime DateOfRelease { get; set; }

   public static List&lt;Books&gt; GetBooks()
  {
     List&lt;Books&gt; list = new List&lt;Books&gt;();
     list.Add(new Books { ID = "001", 
     Title = "Programming in C#", 
     Price = 634.76m, 
     DateOfRelease = Convert.ToDateTime("2010-02-05") });
     
     list.Add(new Books { ID = "002", 
     Title = "Learn Jave in 30 days", 
     Price = 250.76m, 
     DateOfRelease = Convert.ToDateTime("2011-08-15") });
     
     list.Add(new Books { ID = "003", 
     Title = "Programming in ASP.Net 4.0", 
     Price = 700.00m, 
     DateOfRelease = Convert.ToDateTime("2011-02-05") });
     
     list.Add(new Books { ID = "004", 
     Title = "VB.Net Made Easy", 
     Price = 500.99m, 
     DateOfRelease = Convert.ToDateTime("2011-12-31") });
     
     list.Add(new Books { ID = "005", 
     Title = "Programming in C", 
     Price = 314.76m, 
     DateOfRelease = Convert.ToDateTime("2010-02-05") });
     
     list.Add(new Books { ID = "006", 
     Title = "Programming in C++", 
     Price = 456.76m, 
     DateOfRelease = Convert.ToDateTime("2010-02-05") });
     
     list.Add(new Books { ID = "007", 
     Title = "Datebase Developement", 
     Price = 1000.76m, 
     DateOfRelease = Convert.ToDateTime("2010-02-05") });
     return list;
  }

}
</pre></td></tr>
</table>
<p>The web page using this class has a simple label control, which will display the titles of the books. The Page_Load event creates a list of books and returns the titles by using LINQ query:</p>
<table class="src" cellpadding="5">
<tr><td><pre>
public partial class simplequery : System.Web.UI.Page
{
   protected void Page_Load(object sender, EventArgs e)
   {
      List&lt;Books&gt; books = Books.GetBooks();
      var booktitles = from b in books select b.Title;

      foreach (var title in booktitles)
         lblbooks.Text += String.Format("{0} &lt;br /&gt;", title);
   }
}
</pre></td></tr>
</table>
<p>When the page is run, the label will display the results of the query:</p>
<center>
<img src="../images/linq_result.html" alt="LINQ Result" />
</center>
<p>The above LINQ expression:</p>
<table class="src" cellpadding="5">
<tr><td><pre>
var booktitles = 
from b in books 
select b.Title;
</pre></td></tr>
</table>
<p>Is equivalent to the following SQL query:</p>
<table class="src" cellpadding="5">
<tr><td><pre>
SELECT Title from Books
</pre></td></tr>
</table>
<h1>LINQ Operators:</h1>
<p>Apart from the operators used so far, there are several other operators, which implement all query clauses. Let us look at some of the operators and clauses.</p>
<h1>The Join clause:</h1>
<p>The 'join clause' in SQL is used for joining two data tables and displays a data set containing columns from both the tables. LINQ is also capable of that. To check this, add another class named Saledetails.cs in the previous project:</p>
<table class="src" cellpadding="5">
<tr><td><pre>
public class Salesdetails
{
   public int sales { get; set; }
   public int pages { get; set; }
   public string ID {get; set;}

   public static IEnumerable&lt;Salesdetails&gt; getsalesdetails()
   { 
      Salesdetails[] sd = 
      {
      new Salesdetails { ID = "001", pages=678, sales = 110000},
      new Salesdetails { ID = "002", pages=789, sales = 60000},
      new Salesdetails { ID = "003", pages=456, sales = 40000},
      new Salesdetails { ID = "004", pages=900, sales = 80000},
      new Salesdetails { ID = "005", pages=456, sales = 90000},
      new Salesdetails { ID = "006", pages=870, sales = 50000},
      new Salesdetails { ID = "007", pages=675, sales = 40000},
      };
      return sd.OfType&lt;Salesdetails&gt;();
   }
}
</pre></td></tr>
</table>
<p>Add the codes in the Page_Load event handler to query on both the tables using the join clause:</p>
<table class="src" cellpadding="5">
<tr><td><pre>
protected void Page_Load(object sender, EventArgs e)
{
   IEnumerable&lt;Books&gt; books = Books.GetBooks();
   IEnumerable&lt;Salesdetails&gt; sales = 
                       Salesdetails.getsalesdetails();
   var booktitles = from b in books
             join s in sales
             on b.ID equals s.ID
             select new { Name = b.Title, Pages = s.pages };
   foreach (var title in booktitles)
      lblbooks.Text += String.Format("{0} &lt;br /&gt;", title);
}
</pre></td></tr>
</table>
<p>The resulted Page:</p>
<center>
<img src="../images/linq_result2.html" alt="LINQ Result2" />
</center>
<h1>The Where clause:</h1>
<p>The 'where clause' allows adding some conditional filters to the query. For example, if you want to see the books, where the number of pages are more than 500, change the Page_Load event handler to:</p>
<table class="src" cellpadding="5">
<tr><td><pre>
var booktitles = from b in books
          join s in sales
          on b.ID equals s.ID
          where s.pages > 500
          select new { Name = b.Title, Pages = s.pages };
</pre></td></tr>
</table>
<p>The query returns only those rows, where the number of pages is more than 500:</p>
<center>
<img src="../images/linq_result3.html" alt="LINQ Result3" />
</center>
<h1>The Orderby and Orderbydescending clauses:</h1>
<p>These clauses allow sorting the query results. To query the titles, number of pages and price of the book, sorted by the price, write the following code in the Page_Load event handler:</p>
<table class="src" cellpadding="5">
<tr><td><pre>
var booktitles = from b in books
                 join s in sales
                 on b.ID equals s.ID
                 orderby b.Price
                 select new { Name = b.Title, 
                 Pages = s.pages, Price = b.Price};
</pre></td></tr>
</table>
<p>The returned tuples are:</p>
<center>
<img src="../images/linq_result4.html" alt="LINQ Result4" />
</center>
<h1>The Let clause:</h1>
<p>The let clause allows defining a variable and assigning it a value calculated from the data values. For example, to calculate the total sale from the above two sales, you need to calculate: </p>
<table class="src" cellpadding="5">
<tr><td><pre>
TotalSale = Price of the Book * Sales
</pre></td></tr>
</table>
<p>To achieve this, add the following code snippets in the Page_Load event handler:</p>
<p>The let clause allows defining a variable and assigning it a value calculated from the data values. For example, to calculate the total sale from the above two sales, you need to calculate: </p>
<table class="src" cellpadding="5">
<tr><td><pre>
var booktitles = from b in books
     join s in sales
     on b.ID equals s.ID
     let totalprofit = (b.Price * s.sales)
     select new { Name = b.Title, TotalSale = totalprofit};
</pre></td></tr>
</table>
<p>The resultant query page looks like:</p>
<center>
<img src="../images/linq_result5.html" alt="LINQ Result5" />
</center>
<br />
<hr />
<a href="asp.net_debugging.html"><img alt="previous" border="0" src="../images/previous.gif" /></a>
<a href="asp.net_security.html"><img alt="next" border="0" src="../images/next.gif" /></a>
<a href='../cgi-bin/printversion78e9.html?tutorial=asp.net&amp;file=asp.net_linq.htm' target="_blank">
<img src="../images/print.gif" alt="Printer Friendly" border="0" /></a>
<br />
<hr />
<!-- PRINTING ENDS HERE -->
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 336;
google_ad_height = 280;
google_ad_format = "336x280_as";
google_ad_type = "text_image";
google_ad_channel ="9030538898";
google_color_border="ffffff";
google_color_link="900b09";
google_color_url="000000";
google_color_text="000000";
//--></script>
<script type="text/javascript" src="../../pagead2.googlesyndication.com/pagead/show_ads.js"></script>
</td></tr>
</table>
</td>
<td class="right" align="center" valign="top">
<br /><br />
<table width="100%" cellpadding="0" cellspacing="0">
<tr valign="middle">
<td  class="top" style="border:0px;">
&nbsp;&nbsp;
</td>
</tr>
</table>
<table class="right"  cellpadding="0" cellspacing="0">
<tr>
<td align="center" class="right">
<p>
<u>Advertisements</u>
</p>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<br /><br /></td></tr></table>
</td></tr></table>
</center>
</body>

<!-- Mirrored from www.tutorialspoint.com/asp.net/asp.net_linq.htm by HTTrack Website Copier/3.x [XR&CO'2010], Mon, 15 Apr 2013 05:01:08 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
</html>
