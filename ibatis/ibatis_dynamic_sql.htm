<!doctype html> 
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]> <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]> <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]> <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--><html lang="en"><!--<![endif]-->

<!-- Mirrored from www.tutorialspoint.com/ibatis/ibatis_dynamic_sql.htm by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 13 Apr 2013 21:05:36 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8">
<title>iBATIS| iBATIS Dynamic SQL| Dynamic Queries with iBATIS| Example of Dynamic SQL iBATIS</title>
<link rel="shortcut icon" href="../favicon.png" type="image/x-icon" />
<meta name="description" content="iBATIS| iBATIS Dynamic SQL| Dynamic Queries with iBATIS| Example of Dynamic SQL iBATIS - Free iBATIS Tutorials, Reference Manual, and Guide for beginners. Learn how iBATIS framework works starting from environment setup, reading, writing, updating, deleting database records using result maps, dynamic  and inline SQL." />
<meta name="Keywords" content="Free, iBATIS, Tutorials, Reference, Manual, Guide, Beginners" />
<base  />
<link rel="stylesheet" type="text/css" href="../scripts/style.css" />
<link rel="stylesheet" type="text/css" href="../scripts/prettify.css" />
<script type="text/javascript" src="../scripts/prettify.js"></script>
<style media="screen" type="text/css">
#topmenu a:hover {text-decoration:none;color:#d8b525 !important;background-color:transparent;font-weight:bold;}
#header{ 
background:#d8b525 !important;
}
#topmenu
{
background-color:#8C730C !important;
}
#leftcol ul.menu li.heading 
{
background:#d8b525 !important;
border:1px solid #8C730C !important;
}
#leftcol, #middlecol, #rightcol {min-height:1520px; padding:0px;}
</style>
<script src="../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-232293-6";
urchinTracker();
</script>
</head>
<body onload="prettyPrint()">
<div id="header">
<div class="wrapper">
<h1 class="logo"><a href="../index.htm">Tutorials Point - Simply Easy Learning</a></h1>
<div id="search">
<form method="get" id="searchform" name="searchform" action="http://www.google.com/search" target="_blank">
<input type="hidden" name="sitesearch" value="www.tutorialspoint.com"/>
<input type="text" name="as_q" id="s" value="Search this site..." onfocus="if (this.value == 'Search this site...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search this site...';}"/>
<input value="FORID:11" name="cof" type="hidden"/>
<input type="hidden" name="ie" value="ISO-8859-1" />
<input class="submit btn" type="image" src="../images/icon-search.png" alt="Go"/>
</form>
</div>
</div>
</div>
<div id="topmenu">
<div class="wrapper">
<div id="left">
<a href="../index.htm" target="_top">HOME </a>
<a href="../java/index.htm" target="_top">JAVA </a>
<a href="../php/index.htm" target="_top">PHP </a>
<a href="../python/index.htm" target="_top">Python </a>
<a href="../ruby/index.htm" target="_top">Ruby </a>
<a href="../perl/index.htm" target="_top">Perl </a>
<a href="../html/index.htm" target="_top">HTML </a>
<a href="../css/index.htm" target="_top">CSS </a>
<a href="../javascript/index.htm" target="_top">Javascript </a>
<a href="../mysql/index.htm" target="_top">MySQL </a>
<a href="../cplusplus/index.htm" target="_top">C++ </a>
<a href="../unix/index.htm" target="_top">UNIX </a>
<a href="../more.htm" target="_top">MORE...</a>
</div>
<div id="right">
<a href="../references.htm" target="_top">REFERENCES</a> |
<a href="../forums/index.html" target="_top">FORUM</a> |
<a href="../about/index.htm" target="_top">ABOUT</a> |
<a href="../about/contact_us.htm" target="_top">CONTACT</a>
</div>
</div>
</div>
<div class="wrapper">
<div id="leftcol">
<div class="mini-logo">
<img src="../images/ibatis-mini-logo.png" alt="iBATIS Tutorial" />
</div>
<ul class="menu">
<li class="heading">iBATIS Tutorial</li>
<li><a target="_top" href="index.htm">iBATIS - Home</a></li>
<li><a target="_top" href="ibatis_overview.htm">iBATIS - Overview</a></li>
<li><a target="_top" href="ibatis_environment.htm">iBATIS - Environment</a></li>
<li><a target="_top" href="ibatis_create_operation.htm">iBATIS - Create Operation</a></li>
<li><a target="_top" href="ibatis_read_operation.htm">iBATIS - Read Operation</a></li>
<li><a target="_top" href="ibatis_update_operation.htm">iBATIS - Update Operation</a></li>
<li><a target="_top" href="ibatis_delete_operation.htm">iBATIS - Delete Operation</a></li>
<li><a target="_top" href="ibatis_result_maps.htm">iBATIS - Result Maps</a></li>
<li><a target="_top" href="ibatis_stored_procedures.htm">iBATIS - Stored Procedures</a></li>
<li><a target="_top" href="ibatis_dynamic_sql.htm"><b>iBATIS - Dynamic SQL</b></a></li>
<li><a target="_top" href="ibatis_debugging.htm">iBATIS - Debugging</a></li>
<li><a target="_top" href="ibatis_vs_hibernate.htm">iBATIS - Hibernate</a></li>
<li><a target="_top" href="ibator_introduction.htm">iBATOR- Introduction</a></li>
</ul>
<ul class="menu">
<li class="heading">iBATIS Useful Resources</li>
<li><a target="_top" href="ibatis_quick_guide.htm">iBATIS - Quick Guide</a></li>
<li><a target="_top" href="ibatis_useful_resources.htm">iBATIS - Useful Resources</a></li>
</ul>
<ul class="menu">
<li class="sreading">Selected Reading</li>
<li><a target="_top" href="../developers_best_practices/index.htm">Developer's Best Practices</a></li>
<li><a target="_top" href="../computer_glossary.htm">Computer Glossary</a></li>
<li><a target="_top" href="../computer_whoiswho.htm">Who is Who</a></li>
</ul>
</div><!-- leftcol -->
<div id="middlecol">
<!-- PRINTING STARTS HERE -->
<div class="content">
<h1>iBATIS - Dynamic SQL</h1>
<div class="topgooglead">
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "image";
google_ad_channel = "";
//--></script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/show_ads.js"> 
</script>
</div>
<hr />
<div class="pre-btn">
<a href="ibatis_stored_procedures.htm">Previous Page</a>
</div>
<div class="nxt-btn">
<a href="ibatis_debugging.htm">Next Page</a>
</div>
<div class="clearer"></div>
<hr />
<p>Using dynamic queries is a very powerful feature of iBatis. Sometime you have changing WHERE clause criterion based on your parameter object's state. In such situation iBATIS provides a set of dynamic SQL tags that can be used within mapped statements to enhance the reusability and flexibility of the SQL.</p>
<p>All the logic is put in .XML file using some additional tags. Following is an example where SELECT statement would work in two ways:</p>
<ul class="list">
<li><p>If you would pass an ID then it would return all the records corresponding to that ID,</p></li>
<li><p>otherwise it would return all the records where employee ID is set to NULL.</p></li>
</ul>
<pre class="prettyprint">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE sqlMap 
PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
"http://ibatis.apache.org/dtd/sql-map-2.dtd"&gt;

&lt;sqlMap namespace="Employee"&gt;
&lt;select id="findByID" resultClass="Employee"&gt;
   SELECT * FROM EMPLOYEE
   &lt;dynamic prepend="WHERE "&gt;
      &lt;isNull property="id"&gt;
         id IS NULL
      &lt;/isNull&gt;
      &lt;isNotNull property="id"&gt;
         id = #id#
      &lt;/isNotNull&gt;
   &lt;/dynamic&gt;
&lt;/select&gt;
&lt;/sqlMap&gt;
</pre>
<p>You can check condition using &lt;isNotEmpty&gt; tag as follows. Here condition would be added only when passed property is not empty.</p>
<pre class="prettyprint">
..................
&lt;select id="findByID" resultClass="Employee"&gt;
   SELECT * FROM EMPLOYEE
   &lt;dynamic prepend="WHERE "&gt;
      &lt;isNotEmpty property="id"&gt;
           id = #id#
      &lt;/isNotEmpty&gt;
   &lt;/dynamic&gt;
&lt;/select&gt;
..................
</pre>
<p>If you wan a query where we can select on id and/or first name of an Employee. Here would be your SELECT statement:</p>
<pre class="prettyprint">
..................
&lt;select id="findByID" resultClass="Employee"&gt;
   SELECT * FROM EMPLOYEE
   &lt;dynamic prepend="WHERE "&gt;
      &lt;isNotEmpty prepend="AND" property="id"&gt;
           id = #id#
      &lt;/isNotEmpty&gt;
      &lt;isNotEmpty prepend="OR" property="first_name"&gt;
           first_name = #first_name#
      &lt;/isNotEmpty&gt;
   &lt;/dynamic&gt;
&lt;/select&gt;
..................
</pre>
<h2>Example: Dynamic SQL</h2>
<p>Following example would show how you can write SELECT statement with dynamic SQL. Consider, we have following EMPLOYEE table in MySQL:</p>
<pre class="prettyprint">
CREATE TABLE EMPLOYEE (
   id INT NOT NULL auto_increment,
   first_name VARCHAR(20) default NULL,
   last_name  VARCHAR(20) default NULL,
   salary     INT  default NULL,
   PRIMARY KEY (id)
);
</pre>
<p>This table is having only one record as follows:</p>
<pre class="prettyprint">
mysql&gt; select * from EMPLOYEE;
+----+------------+-----------+--------+
| id | first_name | last_name | salary |
+----+------------+-----------+--------+
|  1 | Zara       | Ali       |   5000 |
|  2 | Roma       | Ali       |   3000 |
|  3 | Noha       | Ali       |   7000 |
+----+------------+-----------+--------+
3 row in set (0.00 sec)
</pre>
<h2>Employee POJO Class:</h2>
<p>To perform read operation, let us have  Employee class in Employee.java file as follows:</p>
<pre class="prettyprint">
public class Employee {
  private int id;
  private String first_name; 
  private String last_name;   
  private int salary;  

  /* Define constructors for the Employee class. */
  public Employee() {}
  
  public Employee(String fname, String lname, int salary) {
    this.first_name = fname;
    this.last_name = lname;
    this.salary = salary;
  }

  /* Here are the method definitions */
  public int getId() {
    return id;
  }
  public String getFirstName() {
    return first_name;
  }
  public String getLastName() {
    return last_name;
  }
  public int getSalary() {
    return salary;
  }
} /* End of Employee */
</pre>
<h2>Employee.xml File:</h2>
<p>To define SQL mapping statement using iBATIS, we would add following modified &lt;select&gt; tag in Employee.xml file and inside this tag definition we would define an "id" which will be used in IbatisReadDy.java file for executing Dynamic SQL SELECT query on database.</p>
<pre class="prettyprint">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE sqlMap 
PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
"http://ibatis.apache.org/dtd/sql-map-2.dtd"&gt;

&lt;sqlMap namespace="Employee"&gt;
&lt;select id="findByID" resultClass="Employee"&gt;
   SELECT * FROM EMPLOYEE
   &lt;dynamic prepend="WHERE "&gt;
      &lt;isNotNull property="id"&gt;
         id = #id#
      &lt;/isNotNull&gt;
   &lt;/dynamic&gt;
&lt;/select&gt;
&lt;/sqlMap&gt;
</pre>
<p>Above SELECT statement would work in two ways (i) If you would pass an ID then it would return records corresponding to that ID (ii) otherwise it would return all the records.</p>
<h2>IbatisReadDy.java File:</h2>
<p>This file would have application level logic to read conditional records from the Employee table:</p>
<pre class="prettyprint">
import com.ibatis.common.resources.Resources;
import com.ibatis.sqlmap.client.SqlMapClient;
import com.ibatis.sqlmap.client.SqlMapClientBuilder;
import java.io.*;
import java.sql.SQLException;
import java.util.*;

public class IbatisReadDy{
  public static void main(String[] args)
   throws IOException,SQLException{
   Reader rd=Resources.getResourceAsReader("SqlMapConfig.xml");
   SqlMapClient smc=SqlMapClientBuilder.buildSqlMapClient(rd);

   /* This would read all records from the Employee table.*/
   System.out.println("Going to read records.....");
   Employee rec = new Employee();
   rec.setId(1);

   List &lt;Employee&gt; ems = (List&lt;Employee&gt;)
                   smc.queryForList("Employee.findByID", rec);
   Employee em = null;
   for (Employee e : ems) {
      System.out.print("  " + e.getId());
      System.out.print("  " + e.getFirstName());
      System.out.print("  " + e.getLastName());
      System.out.print("  " + e.getSalary());
      em = e; 
      System.out.println("");
   }    

   System.out.println("Records Read Successfully ");

  }
} 
</pre>
<h2>Compilation and Run:</h2>
<p>Here are the steps to compile and run the above mentioned software. Make sure you have set PATH and CLASSPATH appropriately before proceeding for the compilation and execution.</p>
<ul class="list">
<li><p>Create Employee.xml as shown above.</p></li>
<li><p>Create Employee.java as shown above and compile it.</p></li>
<li><p>Create IbatisReadDy.java  as shown above and compile it.</p></li>
<li><p>Execute IbatisReadDy binary to run the program.</p></li>
</ul>
<p>You would get following result, and a record would be read from the EMPLOYEE table.</p>
<pre class="prettyprint">
Going to read records.....
  1  Zara  Ali  5000
Record Reads Successfully
</pre>
<p>Try above example by passing <b>null</b> as <i>smc.queryForList("Employee.findByID", null)</i>.</p> 
<hr />
<div class="pre-btn">
<a href="ibatis_stored_procedures.htm">Previous Page</a>
</div>
<div class="print-btn">
<a href="../cgi-bin/printpage.html" target="_blank">Print Version</a>
</div>
<div class="pdf-btn">
<a href="pdf/ibatis_dynamic_sql.pdf" alt="iBATIS| iBATIS Dynamic SQL| Dynamic Queries with iBATIS| Example of Dynamic SQL iBATIS" target="_blank">PDF Version</a>
</div>
<div class="nxt-btn">
<a href="ibatis_debugging.htm">Next Page</a>
</div>
<div class="clearer"></div>
<hr />
</div>
<!-- PRINTING ENDS HERE -->
<div class="bottomgooglead">
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 336;
google_ad_height = 280;
google_ad_format = "336x280_as";
google_ad_type = "text";
google_ad_channel ="9030538898";
google_color_border="ffffff";
google_color_link="900b09";
google_color_url="000000";
google_color_text="000000";
//--></script>
<script type="text/javascript" src="../../pagead2.googlesyndication.com/pagead/show_ads.js"></script>
</div>
</div><!-- middlecol -->
<div id="rightcol">
<!-- AddThis Button BEGIN -->
<div class="addthis">
<div class="addthis_toolbox addthis_default_style">
<a class="addthis_button_facebook"></a>
<a class="addthis_button_twitter"></a>
<script type="text/javascript">
<!--
 document.write('<a class="addthis_button_google_plusone" g:plusone:count="false"></a>');
//-->
</script>
<a class="addthis_button_linkedin"></a>
<a class="addthis_button_email"></a>
<a class="addthis_button_compact"></a>
</div>
<script type="text/javascript" src="../../s7.addthis.com/js/250/addthis_widget.js#pubid=ra-4f661ec623a400f0"></script>
</div>
<!-- AddThis Button END -->
<div class="localad">
<a rel="nofollow" href="http://www.modernindianbabynames.com/" target="_blank" title="Modern Baby Names">Modern Baby Names</a>
</div>
<div class="localad">
<a rel="nofollow" href="http://www.photofuntoos.com/" target="_blank" title="Online Photo Editing">Online Photo Editing</a>
</div>
<div class="rightgooglead">
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/show_ads.js"> 
</script>
</div>
</div><!-- rightcol -->
<div style="clear:both;"></div>
</div><!-- wrapper -->
<div id="footer">
<div class="wrapper">
<div id="bottommenu">
<a href="../asp.net/index.htm" target="_top">ASP.NET </a> |
<a href="../jquery/index.htm" target="_top">jQuery </a> |
<a href="../ajax/index.htm" target="_top">AJAX </a> |
<a href="../ant/index.htm" target="_top">ANT</a> |
<a href="../jsp/index.htm" target="_top">JSP </a> |
<a href="../servlets/index.htm" target="_top">Servlets </a> |
<a href="../log4j/index.htm" target="_top">log4j </a> |
<a href="index.htm" target="_top">iBATIS </a> |
<a href="../hibernate/index.htm" target="_top">Hibernate </a> |
<a href="../jdbc/index.htm" target="_top">JDBC </a> |
<a href="../struts_2/index.htm" target="_top">Struts </a> |
<a href="../html5/index.htm" target="_top">HTML5 </a> |
<a href="../sql/index.htm" target="_top">SQL </a> |
<a href="../mysql/index.htm" target="_top">MySQL </a> |
<a href="../cplusplus/index.htm" target="_top">C++ </a> |
<a href="../unix/index.htm" target="_top">UNIX </a>
</div>
<div id="copyright">
<p>Copyright &copy; 2013 by tutorialspoint. All Rights Reserved.</p>
</div>
</div>
</div>
</body>

<!-- Mirrored from www.tutorialspoint.com/ibatis/ibatis_dynamic_sql.htm by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 13 Apr 2013 21:05:36 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
</html>