<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from www.tutorialspoint.com/unix_commands/ip6tables.htm by HTTrack Website Copier/3.x [XR&CO'2010], Mon, 15 Apr 2013 05:04:48 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>ip6tables - Unix, Linux Command</title>
<meta name="Description" Content="ip6tables - Unix, Linux Command Manual Pages (Manpages) ,  Learning fundamentals of UNIX and Linux in simple and easy steps : A beginner's tutorial containing complete knowledge of Unix Korn  and Bourne Shell and Programming, Utilities, File System, Directories, Memory Management, Special Variables, vi editor, Processes" />
<meta name="Keywords" content="Unix, Tutorials, Learning, Operating, System, OS, Beginners, Basics, System Calls, Korn, Bourne, Shell,Programming, Utilities, File System, Directories, Memory Management, Special Variables, vi editor, Processes" />
<meta http-equiv="pragma" content="no-cache" />
<meta http-equiv="cache-control" content="no-cache" />
<base  />
<link rel="stylesheet" type="text/css" href="../tp.css" />
<script src="../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-232293-6";
urchinTracker();
</script>
</head>
<body>
<center>
<a name="top"></a>
<table border="0" class="main" cellpadding="2" cellspacing="0">
<tr>
<td class="content" valign="top" align="left">
<a href="../index-2.html"><img src="../images/tp-logo.gif" border="0"  alt="Tutorials Point" /></a>
<br />
<br />
<div  class="search">
<!-- SiteSearch Google -->
<form method="get" action="http://www.google.com/custom" target="google_window">
<table border="0">
<tr><td nowrap="nowrap" valign="top" align="center" height="32">
<a href="http://www.google.com/">
<img src="../../www.google.com/logos/Logo_25wht.gif" border="0" alt="Google" align="middle"></img></a>
</td>
</tr>
<tr>
<td nowrap="nowrap">
<input type="hidden" name="domains" value="www.tutorialspoint.com"></input>
<input type="text" name="q" size="20" maxlength="255" value=""></input>
<input type="submit" name="sa" style="width:20px;font-weight:bold" value="..."></input>
</td></tr>
<tr>
<td nowrap="nowrap">
<table>
<tr>
<td>
<input type="radio" name="sitesearch" value="" checked="checked"></input>
<font size="-1" color="#000000">Web</font>
</td>
<td>
<input type="radio" name="sitesearch" value="www.tutorialspoint.com"></input>
<font size="-1" color="#000000">This Site</font>
</td>
</tr>
</table>
<input type="hidden" name="client" value="pub-7133395778201029"></input>
<input type="hidden" name="forid" value="1"></input>
<input type="hidden" name="ie" value="ISO-8859-1"></input>
<input type="hidden" name="oe" value="ISO-8859-1"></input>
<input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:336699;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;FORID:1"></input>
<input type="hidden" name="hl" value="en"></input>
</td></tr></table>
</form>
<!-- SiteSearch Google -->
</div>
<br />
&nbsp;&nbsp;<b>Unix for Beginners</b>
<div  class="left">
<ul class="menu">
<li><a class="left" target="_top" href="../unix/index.html">Unix - Home</a></li>
<li><a class="left" target="_top" href="../unix/unix-getting-started.html">Unix - Getting Started</a></li>
<li><a class="left" target="_top" href="../unix/unix-file-management.html">Unix - File Management</a></li>
<li><a class="left" target="_top" href="../unix/unix-directories.html">Unix - Directories</a></li>
<li><a class="left" target="_top" href="../unix/unix-file-permission.html">Unix - File Permission</a></li>
<li><a class="left" target="_top" href="../unix/unix-environment.html">Unix - Environment</a></li>
<li><a class="left" target="_top" href="../unix/unix-basic-utilities.html">Unix - Basic Utilities</a></li>
<li><a class="left" target="_top" href="../unix/unix-pipes-filters.html">Unix - Pipes &amp; Filters</a></li>
<li><a class="left" target="_top" href="../unix/unix-processes.html">Unix - Processes</a></li>
<li><a class="left" target="_top" href="../unix/unix-communication.html">Unix - Communication</a></li>
<li><a class="left" target="_top" href="../unix/unix-vi-editor.html">Unix - The vi Editor</a></li>
</ul>
</div>
<br />
&nbsp;&nbsp;<b>Unix Shell Programming</b>
<div  class="left">
<ul class="menu">
<li><a class="left" target="_top" href="../unix/unix-shell.html">Unix - What is Shell?</a></li>
<li><a class="left" target="_top" href="../unix/unix-using-variables.html">Unix - Using Variables</a></li>
<li><a class="left" target="_top" href="../unix/unix-special-variables.html">Unix - Special Variables</a></li>
<li><a class="left" target="_top" href="../unix/unix-using-arrays.html">Unix - Using Arrays</a></li>
<li><a class="left" target="_top" href="../unix/unix-basic-operators.html">Unix - Basic Operators</a></li>
<li><a class="left" target="_top" href="../unix/unix-decision-making.html">Unix - Decision Making</a></li>
<li><a class="left" target="_top" href="../unix/unix-shell-loops.html">Unix - Shell Loops</a></li>
<li><a class="left" target="_top" href="../unix/unix-loop-control.html">Unix - Loop Control</a></li>
<li><a class="left" target="_top" href="../unix/unix-shell-substitutions.html">Unix - Shell Substitutions</a></li>
<li><a class="left" target="_top" href="../unix/unix-quoting-mechanisms.html">Unix - Quoting Mechanisms</a></li>
<li><a class="left" target="_top" href="../unix/unix-io-redirections.html">Unix - IO Redirections</a></li>
<li><a class="left" target="_top" href="../unix/unix-shell-functions.html">Unix - Shell Functions</a></li>
<li><a class="left" target="_top" href="../unix/unix-manpage-help.html">Unix - Manpage Help</a></li>
</ul>
</div>
<br />
&nbsp;&nbsp;<b>Advanced Unix</b>
<div  class="left">
<ul class="menu">
<li><a class="left" target="_top" href="../unix/unix-regular-expressions.html">Unix - Regular Expressions</a></li>
<li><a class="left" target="_top" href="../unix/unix-file-system.html">Unix - File System Basics</a></li>
<li><a class="left" target="_top" href="../unix/unix-user-administration.html">Unix - User Administration</a></li>
<li><a class="left" target="_top" href="../unix/unix-system-performance.html">Unix - System Performance</a></li>
<li><a class="left" target="_top" href="../unix/unix-system-logging.html">Unix - System Logging</a></li>
<li><a class="left" target="_top" href="../unix/unix-signals-traps.html">Unix - Signals and Traps</a></li>
</ul>
</div>
<br />
&nbsp;&nbsp;<b>Unix Useful References</b>
<div  class="left">
<ul class="menu">
<li><a class="left" target="_top" href="../unix/unix-useful-commands.html">Unix - Useful Commands</a></li>
<li><a class="left" target="_top" href="../unix/unix-quick-guide.html">Unix - Quick Guide</a></li>
<li><a class="left" target="_top" href="../unix/unix-builtin-functions.html">Unix - Builtin Functions</a></li>
<li><a class="left" target="_top" href="../unix_system_calls/index.html">Unix - System Calls</a></li>
<li><a class="left" target="_top" href="index.html"><b>Unix - Commands List</b></a></li>
</ul>
</div>
<br />
&nbsp;&nbsp;<b>Unix Useful Resources</b>
<div  class="left">
<ul class="menu">
<li><a class="left" target="_top" href="../unix/unix-useful-resources.html">Unix Useful Resources</a></li>
</ul>
</div>
<br />
&nbsp;&nbsp;<b>Selected Reading</b>
<div  class="left">
<ul class="menu">
<li><a class="left" target="_top" href="../computer_glossary.html">Computer Glossary</a></li>
<li><a class="left" target="_top" href="../computer_whoiswho.html">Who is Who</a></li>
</ul>
</div>
<br /><br />
<small>&copy; 2013 TutorialsPoint.COM </small>
</td>
<td valign="top">
<br /><br />
<table cellpadding="0" cellspacing="0">
<tr valign="middle">
<td  style="width:20px;"></td>
<td  class="top">
&nbsp;&nbsp;<a class="top" href="../index-2.html">Home</a>&nbsp;&nbsp;
</td>
<td  style="width:20px;"></td>
<td  class="top">
&nbsp;&nbsp;<a class="top" href="../references.html">References</a>&nbsp;&nbsp;
</td>
<td  style="width:20px;"></td>
<td  class="top">
&nbsp;&nbsp;<a class="top" href="../forums/index.html">Discussion Forums</a>&nbsp;&nbsp;
</td>
<td  style="width:20px;"></td>
<td  class="top">
&nbsp;&nbsp;<a class="top" href="../about/index.html">About TP</a>&nbsp;&nbsp;
</td>
</tr>
</table>
<table class="middle" cellpadding="5" cellspacing="0">
<tr>
<td>
<!-- PRINTING STARTS HERE -->
<h1>ip6tables - Unix, Linux Command</h1>
<hr />
<a href="index.html"><img alt="previous" border="0" src="../images/previous.gif" /></a>
<a href="index.html"><img alt="next" border="0" src="../images/next.gif" /></a>
<!-- AddThis Bookmark Button BEGIN -->
<a href="http://www.addthis.com/bookmark.php" rel="nofollow" onclick="addthis_url   = location.href; addthis_title = document.title; return addthis_click(this);" target="_blank"><img src="../images/add-this.gif" border="0" alt="AddThis Social Bookmark Button" /></a> <script type="text/javascript">var addthis_pub = 'tutorialspoint';</script><script type="text/javascript" src="http://s9.addthis.com/js/widget.php?v=10"></script>
<script type="text/javascript">var addthis_pub = 'tutorialspoint';</script><script type="text/javascript" src="http://s9.addthis.com/js/widget.php?v=10"></script>  
<!-- AddThis Bookmark Button END -->
<br />
<br />
<hr/><div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "image";
google_ad_channel = "";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.js"> 
</script>
<hr />
<h1 class="manpages">NAME</h1>
ip6tables - IPv6 packet filter administration
<h1 class="manpages">SYNOPSIS</h1>
<b>ip6tables [-t table] -[AD] </b>chain rule-specification [options] <!-- Need break --><br />
<b>ip6tables [-t table] -I </b>chain [rulenum] rule-specification [options] <!-- Need break --><br />
<b>ip6tables [-t table] -R </b>chain rulenum rule-specification [options] <!-- Need break --><br />
<b>ip6tables [-t table] -D </b>chain rulenum [options] <!-- Need break --><br />
<b>ip6tables [-t table] -[LFZ] </b>[chain] [options] <!-- Need break --><br />
<b>ip6tables [-t table] -N </b>chain <!-- Need break --><br />
<b>ip6tables [-t table] -X </b>[chain] <!-- Need break --><br />
<b>ip6tables [-t table] -P </b>chain target [options] <!-- Need break --><br />
<b>ip6tables [-t table] -E </b>old-chain-name new-chain-name <h1 class="manpages">DESCRIPTION</h1>
<b>Ip6tables</b> is used to set up, maintain, and inspect the tables of IPv6 packet
filter rules in the Linux kernel.  Several different tables
may be defined.  Each table contains a number of built-in
chains and may also contain user-defined chains.
<p>
Each chain is a list of rules which can match a set of packets.  Each
rule specifies what to do with a packet that matches.  This is called
a &#145;target&#146;, which may be a jump to a user-defined chain in the same
table.
<p>
<h1 class="manpages">TARGETS</h1>
A firewall rule specifies criteria for a packet, and a target.  If the
packet does not match, the next rule in the chain is the examined; if
it does match, then the next rule is specified by the value of the
target, which can be the name of a user-defined chain or one of the
special values
<i>ACCEPT</i>, <i>DROP</i>, <i>QUEUE</i>, or
<i>RETURN</i>. <p>
<i>ACCEPT</i> means to let the packet through.
<i>DROP</i> means to drop the packet on the floor.
<i>QUEUE</i> means to pass the packet to userspace.  (How the packet can be received
by a userspace process differs by the particular queue handler.  2.4.x
and 2.6.x kernels up to 2.6.13 include the
<b></b> ip_queue
queue handler.  Kernels 2.6.14 and later additionally include the
<b></b> nfnetlink_queue
queue handler.  Packets with a target of QUEUE will be sent to queue number &#146;0&#146;
in this case. Please also see the
<b></b> NFQUEUE
target as described later in this man page.)
<i>RETURN</i> means stop traversing this chain and resume at the next rule in the
previous (calling) chain.  If the end of a built-in chain is reached
or a rule in a built-in chain with target
<i>RETURN</i> is matched, the target specified by the chain policy determines the
fate of the packet.
<h1 class="manpages">TABLES</h1>
There are currently two independent tables (which tables are present
at any time depends on the kernel configuration options and which
modules are present), as nat table has not been implemented yet.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>-t, --table </b><i>table</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
This option specifies the packet matching table which the command
should operate on.  If the kernel is configured with automatic module
loading, an attempt will be made to load the appropriate module for
that table if it is not already there.
<p>
The tables are as follows:
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>filter</b>: </td></tr><tr valign="top"><td width=4%>&nbsp;</td><td>
This is the default table (if no -t option is passed).  It contains
the built-in chains
<b>INPUT</b> (for packets coming into the box itself),
<b>FORWARD</b> (for packets being routed through the box), and
<b>OUTPUT</b> (for locally-generated packets).
</td></tr>
<tr valign="top"><td colspan="2">
<b>mangle</b>: </td></tr><tr valign="top"><td width=4%>&nbsp;</td><td>
This table is used for specialized packet alteration.  Until kernel
2.4.17 it had two built-in chains:
<b>PREROUTING</b> (for altering incoming packets before routing) and
<b>OUTPUT</b> (for altering locally-generated packets before routing).
Since kernel 2.4.18, three other built-in chains are also supported:
<b>INPUT</b> (for packets coming into the box itself),
<b>FORWARD</b> (for altering packets being routed through the box), and
<b>POSTROUTING</b> (for altering packets as they are about to go out).
</td></tr>
<tr valign="top"><td colspan="2">
<b>raw</b>: </td></tr><tr valign="top"><td width=4%>&nbsp;</td><td>
This table is used mainly for configuring exemptions from connection
tracking in combination with the NOTRACK target.  It registers at the netfilter
hooks with higher priority and is thus called before nf_conntrack, or any other
IP6 tables.  It provides the following built-in chains:
<b>PREROUTING</b> (for packets arriving via any network interface)
<b>OUTPUT</b> (for packets generated by local processes)
</td></tr>
</table>
</td></tr>
</table>
<h1 class="manpages">OPTIONS</h1>
The options that are recognized by
<b>ip6tables</b> can be divided into several different groups.
<h2><i>COMMANDS</i></h2>
These options specify the specific action to perform.  Only one of them
can be specified on the command line unless otherwise specified
below.  For all the long versions of the command and option names, you
need to use only enough letters to ensure that
<b>ip6tables</b> can differentiate it from all other options.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>-A, --append </b><i>chain rule-specification</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Append one or more rules to the end of the selected chain.
When the source and/or destination names resolve to more than one
address, a rule will be added for each possible address combination.
</td></tr>
<tr valign="top"><td colspan="2">
<b>-D, --delete </b><i>chain rule-specification</i> <!-- Consumed .TP -->
<br />
<!-- ignored unsupported tag .ns -->
<b>-D, --delete </b><i>chain rulenum</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Delete one or more rules from the selected chain.  There are two
versions of this command: the rule can be specified as a number in the
chain (starting at 1 for the first rule) or a rule to match.
</td></tr>
<tr valign="top"><td colspan="2">
<b>-I, --insert</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Insert one or more rules in the selected chain as the given rule
number.  So, if the rule number is 1, the rule or rules are inserted
at the head of the chain.  This is also the default if no rule number
is specified.
</td></tr>
<tr valign="top"><td colspan="2">
<b>-R, --replace </b><i>chain rulenum rule-specification</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Replace a rule in the selected chain.  If the source and/or
destination names resolve to multiple addresses, the command will
fail.  Rules are numbered starting at 1.
</td></tr>
<tr valign="top"><td colspan="2">
<b>-L, --list </b>[<i>chain</i>] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
List all rules in the selected chain.  If no chain is selected, all
chains are listed.  As every other iptables command, it applies to the
specified table (filter is the default), so mangle rules get listed by
<table class="src" cellpadding="5" cellspacing="5">
<tr><td><pre>
 ip6tables -t mangle -n -L
</pre></td></tr>
</table>
Please note that it is often used with the
<b>-n</b> option, in order to avoid long reverse DNS lookups.
It is legal to specify the
<b>-Z</b> (zero) option as well, in which case the chain(s) will be atomically
listed and zeroed.  The exact output is affected by the other
arguments given. The exact rules are suppressed until you use
<table class="src" cellpadding="5" cellspacing="5">
<tr><td><pre>
 ip6tables -L -v
</pre></td></tr>
</table>
</td></tr>
<tr valign="top"><td colspan="2">
<b>-F, --flush </b>[<i>chain</i>] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Flush the selected chain (all the chains in the table if none is given).
This is equivalent to deleting all the rules one by one.
</td></tr>
<tr valign="top"><td colspan="2">
<b>-Z, --zero </b>[<i>chain</i>] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Zero the packet and byte counters in all chains.  It is legal to
specify the
<b>-L, --list</b> (list) option as well, to see the counters immediately before they are
cleared. (See above.)
</td></tr>
<tr valign="top"><td colspan="2">
<b>-N, --new-chain </b><i>chain</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Create a new user-defined chain by the given name.  There must be no
target of that name already.
</td></tr>
<tr valign="top"><td colspan="2">
<b>-X, --delete-chain </b>[<i>chain</i>] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Delete the optional user-defined chain specified.  There must be no references
to the chain.  If there are, you must delete or replace the referring
rules before the chain can be deleted.  If no argument is given, it
will attempt to delete every non-builtin chain in the table.
</td></tr>
<tr valign="top"><td colspan="2">
<b>-P, --policy </b><i>chain target</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Set the policy for the chain to the given target.  See the section
<b><a href=#3>TARGETS</a></b> for the legal targets.  Only built-in (non-user-defined) chains can have
policies, and neither built-in nor user-defined chains can be policy
targets.
</td></tr>
<tr valign="top"><td colspan="2">
<b>-E, --rename-chain </b><i>old-chain new-chain</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Rename the user specified chain to the user supplied name.  This is
cosmetic, and has no effect on the structure of the table.
</td></tr>
<tr valign="top"><td>
<b>-h</b> </td><td valign="bottom">
Help.
Give a (currently very brief) description of the command syntax.
</td></tr>
</table>
<h2><i>PARAMETERS</i></h2>
The following parameters make up a rule specification (as used in the
add, delete, insert, replace and append commands).
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>-p, --protocol </b>[!] <i>protocol</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
The protocol of the rule or of the packet to check.
The specified protocol can be one of
<i>tcp</i>, <i>udp</i>, <i>icmpv6</i>, <i>esp</i>, <i>all</i>, or it can be a numeric value, representing one of these protocols or a
different one. A protocol name from /etc/protocols is also allowed.
But IPv6 extension headers except
<i>esp</i> are not allowed.
<i>esp</i>, and
<i>ipv6-nonext</i> can be used with Kernel version 2.6.11 or later.
A "!" argument before the protocol inverts the
test.  The number zero is equivalent to
<i>all</i>. Protocol
<i>all</i> will match with all protocols and is taken as default when this
option is omitted.
</td></tr>
<tr valign="top"><td colspan="2">
<b>-s, --source </b>[!] <i>address</i>[/<i>mask</i>] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Source specification.
<i>Address</i> can be either a hostname (please note that specifying
any name to be resolved with a remote query such as DNS is a really bad idea),
a network IPv6 address (with /mask), or a plain IPv6 address.
(the network name isn&#146;t supported now).
The
<i>mask</i> can be either a network mask or a plain number,
specifying the number of 1&#146;s at the left side of the network mask.
Thus, a mask of
<i>64</i> is equivalent to
<i>ffff:ffff:ffff:ffff:0000:0000:0000:0000</i>. A "!" argument before the address specification inverts the sense of
the address. The flag
<b>--src</b> is an alias for this option.
</td></tr>
<tr valign="top"><td colspan="2">
<b>-d, --destination </b>[!] <i>address</i>[/<i>mask</i>] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Destination specification.
See the description of the
<b>-s</b> (source) flag for a detailed description of the syntax.  The flag
<b>--dst</b> is an alias for this option.
</td></tr>
<tr valign="top"><td colspan="2">
<b>-j, --jump </b><i>target</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
This specifies the target of the rule; i.e., what to do if the packet
matches it.  The target can be a user-defined chain (other than the
one this rule is in), one of the special builtin targets which decide
the fate of the packet immediately, or an extension (see
<b>EXTENSIONS</b> below).  If this
option is omitted in a rule, then matching the rule will have no
effect on the packet&#146;s fate, but the counters on the rule will be
incremented.
</td></tr>
<tr valign="top"><td colspan="2">
<b>-i, --in-interface </b>[!] <i>name</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Name of an interface via which a packet is going to be received (only for
packets entering the
<b>INPUT</b>, <b>FORWARD</b> and
<b>PREROUTING</b> chains).  When the "!" argument is used before the interface name, the
sense is inverted.  If the interface name ends in a "+", then any
interface which begins with this name will match.  If this option is
omitted, any interface name will match.
</td></tr>
<tr valign="top"><td colspan="2">
<b>-o, --out-interface </b>[!] <i>name</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Name of an interface via which a packet is going to be sent (for packets
entering the
<b>FORWARD</b> and
<b>OUTPUT</b> chains).  When the "!" argument is used before the interface name, the
sense is inverted.  If the interface name ends in a "+", then any
interface which begins with this name will match.  If this option is
omitted, any interface name will match.
</td></tr>
<tr valign="top"><td colspan="2">
<b>-c, --set-counters  PKTS BYTES</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
This enables the administrator to initialize the packet and byte
counters of a rule (during
<b>INSERT,</b> <b>APPEND,</b> <b>REPLACE</b> operations).
</td></tr>
</table>
<h2><i>OTHER OPTIONS</i></h2>
The following additional options can be specified:
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>-v, --verbose</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Verbose output.  This option makes the list command show the interface
name, the rule options (if any), and the TOS masks.  The packet and
byte counters are also listed, with the suffix &#146;K&#146;, &#146;M&#146; or &#146;G&#146; for
1000, 1,000,000 and 1,000,000,000 multipliers respectively (but see
the
<b>-x</b> flag to change this).
For appending, insertion, deletion and replacement, this causes
detailed information on the rule or rules to be printed.
</td></tr>
<tr valign="top"><td colspan="2">
<b>-n, --numeric</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Numeric output.
IP addresses and port numbers will be printed in numeric format.
By default, the program will try to display them as host names,
network names, or services (whenever applicable).
</td></tr>
<tr valign="top"><td colspan="2">
<b>-x, --exact</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Expand numbers.
Display the exact value of the packet and byte counters,
instead of only the rounded number in K&#146;s (multiples of 1000)
M&#146;s (multiples of 1000K) or G&#146;s (multiples of 1000M).  This option is
only relevant for the
<b>-L</b> command.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--line-numbers</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
When listing rules, add line numbers to the beginning of each rule,
corresponding to that rule&#146;s position in the chain.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--modprobe=command</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
When adding or inserting rules into a chain, use
<b>command</b> to load any necessary modules (targets, match extensions, etc).
</td></tr>
</table>
<h1 class="manpages">MATCH EXTENSIONS</h1>
ip6tables can use extended packet matching modules.  These are loaded
in two ways: implicitly, when
<b>-p</b> or
<b>--protocol</b> is specified, or with the
<b>-m</b> or
<b>--match</b> options, followed by the matching module name; after these, various
extra command line options become available, depending on the specific
module.  You can specify multiple extended match modules in one line,
and you can use the
<b>-h</b> or
<b>--help</b> options after the module has been specified to receive help specific
to that module.
<p>
The following are included in the base package, and most of these can
be preceded by a
<b>!</b> to invert the sense of the match.
<h2><i>ah</i></h2>
This module matches the parameters in Authentication header of IPsec packets.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--ahspi </b>[!] <i>spi</i>[:<i>spi</i>] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches SPI.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--ahlen </b>[!] <i>length</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Total length of this header in octets.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--ahres</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches if the reserved field is filled with zero.
</td></tr>
</table>
<h2><i>condition</i></h2>
This matches if a specific /proc filename is &#146;0&#146; or &#146;1&#146;.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--condition </b>[!] <i>filename</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Match on boolean value stored in /proc/net/ip6t_condition/filename file
</td></tr>
</table>
<h2><i>dst</i></h2>
This module matches the parameters in Destination Options header
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--dst-len </b>[!] <i>length</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Total length of this header in octets.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--dst-opts </b><i>type</i>[:<i>length</i>][,<i>type</i>[:<i>length</i>]...] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
numeric type of option and the length of the option data in octets.
</td></tr>
</table>
<h2><i>esp</i></h2>
This module matches the SPIs in ESP header of IPsec packets.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--espspi </b>[!] <i>spi</i>[:<i>spi</i>] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
</td></tr>
</table>
<h2><i>eui64</i></h2>
This module matches the EUI-64 part of a stateless autoconfigured IPv6 address.
It compares the EUI-64 derived from the source MAC address in Ehternet frame
with the lower 64 bits of the IPv6 source address. But "Universal/Local"
bit is not compared. This module doesn&#146;t match other link layer frame, and
is only valid in the
<b>PREROUTING</b>, <b>INPUT</b> and
<b>FORWARD</b> chains.
<h2><i>frag</i></h2>
This module matches the parameters in Fragment header.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--fragid </b>[!] <i>id</i>[:<i>id</i>] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches the given Identification or range of it.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--fraglen </b>[!] <i>length</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
This option cannot be used with kernel version 2.6.10 or later. The length of
Fragment header is static and this option doesn&#146;t make sense.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--fragres </b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches if the reserved fields are filled with zero.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--fragfirst </b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches on the first fragment.
</td></tr>
<tr valign="top"><td colspan="2">
<b>[--fragmore]</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches if there are more fragments.
</td></tr>
<tr valign="top"><td colspan="2">
<b>[--fraglast]</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches if this is the last fragement.
</td></tr>
</table>
<h2><i>fuzzy</i></h2>
This module matches a rate limit based on a fuzzy logic controller [FLC]
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--lower-limit </b><i>number</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Specifies the lower limit (in packets per second).
</td></tr>
<tr valign="top"><td colspan="2">
<b>--upper-limit </b><i>number</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Specifies the upper limit (in packets per second).
</td></tr>
</table>
<h2><i>hbh</i></h2>
This module matches the parameters in Hop-by-Hop Options header
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--hbh-len </b>[!] <i>length</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Total length of this header in octets.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--hbh-opts </b><i>type</i>[:<i>length</i>][,<i>type</i>[:<i>length</i>]...] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
numeric type of option and the length of the option data in octets.
</td></tr>
</table>
<h2><i>hl</i></h2>
This module matches the Hop Limit field in the IPv6 header.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--hl-eq </b>[!] <i>value</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches if Hop Limit equals <i>value</i>.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--hl-lt </b><i>value</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches if Hop Limit is less than <i>value</i>.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--hl-gt </b><i>value</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches if Hop Limit is greater than <i>value</i>.
</td></tr>
</table>
<h2><i>icmpv6</i></h2>
This extension is loaded if &#145;--protocol ipv6-icmp&#146; or &#145;--protocol icmpv6&#146; is
specified. It provides the following option:
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--icmpv6-type </b>[!] <i>type</i>[/<i>code</i>]|<i>typename</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
This allows specification of the ICMPv6 type, which can be a numeric
ICMPv6
<i>type</i>, <i>type</i> and
<i>code</i>, or one of the ICMPv6 type names shown by the command
<table class="src" cellpadding="5" cellspacing="5">
<tr><td><pre>
 ip6tables -p ipv6-icmp -h
</pre></td></tr>
</table>
</td></tr>
</table>
<h2><i>ipv6header</i></h2>
This module matches IPv6 extension headers and/or upper layer header.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--header </b>[!] <i>header</i>[,<i>header</i>...] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches the packet which EXACTLY includes all specified headers. The headers
encapsulated with ESP header are out of scope.
<i>header</i> can be
<i>hop</i>|<i>hop-by-hop</i> (Hop-by-Hop Options header),
<i>dst</i> (Destination Options header),
<i>route</i> (Routing header),
<i>frag</i> (Fragment header),
<i>auth</i> (Authentication header),
<i>esp</i> (Encapsulating Security Payload header),
<i>none</i> (No Next header) which matches 59 in the &#146;Next Header field&#146; of IPv6 header or any IPv6 extension headers, or
<i>proto</i> which matches any upper layer protocol header. A protocol name from /etc/protocols and numeric value also allowed. The number 255 is equivalent to
<i>proto</i>. </td></tr>
<tr valign="top"><td colspan="2">
<b>[--soft]</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches if the packet includes all specified headers with
<b>--header</b>, AT LEAST.
</td></tr>
</table>
<h2><i>length</i></h2>
This module matches the length of the IPv6 payload in octets, or range of it.
IPv6 header itself isn&#146;t counted.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--length </b>[!] <i>length</i>[:<i>length</i>] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
</td></tr>
</table>
<h2><i>limit</i></h2>
This module matches at a limited rate using a token bucket filter.
A rule using this extension will match until this limit is reached
(unless the &#145;!&#146; flag is used).  It can be used in combination with the
<b><a href=#12>LOG</a></b> target to give limited logging, for example.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--limit </b><i>rate</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Maximum average matching rate: specified as a number, with an optional
&#145;/second&#146;, &#145;/minute&#146;, &#145;/hour&#146;, or &#145;/day&#146; suffix; the default is
3/hour.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--limit-burst </b><i>number</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Maximum initial number of packets to match: this number gets
recharged by one every time the limit specified above is not reached,
up to this number; the default is 5.
</td></tr>
</table>
<h2><i>mac</i></h2>
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--mac-source </b>[!] <i>address</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Match source MAC address.  It must be of the form XX:XX:XX:XX:XX:XX.
Note that this only makes sense for packets coming from an Ethernet device
and entering the
<b>PREROUTING</b>, <b>FORWARD</b> or
<b>INPUT</b> chains.
</td></tr>
</table>
<h2><i>mark</i></h2>
This module matches the netfilter mark field associated with a packet
(which can be set using the
<b><a href=#13>MARK</a></b> target below).
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--mark </b><i>value</i>[/<i>mask</i>] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches packets with the given unsigned mark value (if a <i>mask</i> is
specified, this is logically ANDed with the <i>mask</i> before the
comparison).
</td></tr>
</table>
<h2><i>multiport</i></h2>
This module matches a set of source or destination ports.  Up to 15
ports can be specified.  A port range (port:port) counts as two
ports, but range isn&#146;t supported now. It can only be used in conjunction
with
<b>-p tcp</b> or
<b>-p udp</b>. <table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--source-ports </b><i>[!] port</i>[,<i>port</i>[,<i>port:port</i>...]] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Match if the source port is one of the given ports.  The flag
<b>--sports</b> is a convenient alias for this option.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--destination-ports </b><i>[!] port</i>[,<i>port</i>[,<i>port:port</i>...]] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Match if the destination port is one of the given ports.  The flag
<b>--dports</b> is a convenient alias for this option.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--ports </b><i>[!] port</i>[,<i>port</i>[,<i>port:port</i>...]] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Match if the both the source and destination ports are equal to each
other and to one of the given ports.
</td></tr>
</table>
<h2><i>nth</i></h2>
This module matches every &#145;n&#146;th packet
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--every </b><i>value</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Match every &#145;value&#146; packet
</td></tr>
<tr valign="top"><td colspan="2">
<b>[</b><i>--counter </i><b>num</b><i>]</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Use internal counter number &#145;num&#146;.  Default is &#145;0&#146;.
</td></tr>
<tr valign="top"><td colspan="2">
<b>[</b><i>--start </i><b>num</b><i>]</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Initialize the counter at the number &#145;num&#146; insetad of &#145;0&#146;.  Most between &#145;0&#146;
and &#145;value&#146;-1.
</td></tr>
<tr valign="top"><td colspan="2">
<b>[</b><i>--packet </i><b>num</b><i>]</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Match on &#145;num&#146; packet.  Most be between &#145;0&#146; and &#145;value&#146;-1.
</td></tr>
</table>
<h2><i>owner</i></h2>
This module attempts to match various characteristics of the packet
creator, for locally-generated packets.  It is only valid in the
<b>OUTPUT</b> chain, and even this some packets (such as ICMPv6 ping responses) may
have no owner, and hence never match.  This is regarded as experimental.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--uid-owner </b><i>userid</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches if the packet was created by a process with the given
effective user id.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--gid-owner </b><i>groupid</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches if the packet was created by a process with the given
effective group id.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--pid-owner </b><i>processid</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches if the packet was created by a process with the given
process id.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--sid-owner </b><i>sessionid</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches if the packet was created by a process in the given session
group.
</td></tr>
<tr valign="top"><td colspan="2">
<b>NOTE: pid, sid and command matching are broken on SMP</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
</td></tr>
</table>
<h2><i>physdev</i></h2>
This module matches on the bridge port input and output devices enslaved
to a bridge device. This module is a part of the infrastructure that enables
a transparent bridging IP firewall and is only useful for kernel versions
above version 2.5.44.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--physdev-in</b> [!] <i>name</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Name of a bridge port via which a packet is received (only for
packets entering the
<b>INPUT</b>, <b>FORWARD</b> and
<b>PREROUTING</b> chains). If the interface name ends in a "+", then any
interface which begins with this name will match. If the packet didn&#146;t arrive
through a bridge device, this packet won&#146;t match this option, unless &#146;!&#146; is used.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--physdev-out</b> [!] <i>name</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Name of a bridge port via which a packet is going to be sent (for packets
entering the
<b>FORWARD</b>, <b>OUTPUT</b> and
<b>POSTROUTING</b> chains).  If the interface name ends in a "+", then any
interface which begins with this name will match. Note that in the
<b>nat</b> and <b>mangle</b> <b>OUTPUT</b> chains one cannot match on the bridge output port, however one can in the
<b>filter OUTPUT</b> chain. If the packet won&#146;t leave by a bridge device or it is yet unknown what
the output device will be, then the packet won&#146;t match this option, unless
<!-- ignored unsupported tag .!' -->
</td></tr>
<tr valign="top"><td colspan="2">
[!] <b>--physdev-is-in</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches if the packet has entered through a bridge interface.
</td></tr>
<tr valign="top"><td colspan="2">
[!] <b>--physdev-is-out</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches if the packet will leave through a bridge interface.
</td></tr>
<tr valign="top"><td colspan="2">
[!] <b>--physdev-is-bridged</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches if the packet is being bridged and therefore is not being routed.
This is only useful in the FORWARD and POSTROUTING chains.
</td></tr>
</table>
<h2><i>policy</i></h2>
This modules matches the policy used by IPsec for handling a packet.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--dir </b><i>in|out</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Used to select whether to match the policy used for decapsulation or the
policy that will be used for encapsulation.
<b>in</b> is valid in the
<b>PREROUTING, INPUT and FORWARD</b> chains,
<b>out</b> is valid in the
<b>POSTROUTING, OUTPUT and FORWARD</b> chains.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--pol </b><i>none|ipsec</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches if the packet is subject to IPsec processing.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--strict</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Selects whether to match the exact policy or match if any rule of
the policy matches the given policy.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--reqid </b><i>id</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches the reqid of the policy rule. The reqid can be specified with
<b>setkey(8)</b> using
<b>unique:id</b> as level.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--spi </b><i>spi</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches the SPI of the SA.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--proto </b><i>ah|esp|ipcomp</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches the encapsulation protocol.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--mode </b><i>tunnel|transport</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches the encapsulation mode.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--tunnel-src </b><i>addr[/mask]</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches the source end-point address of a tunnel mode SA.
Only valid with --mode tunnel.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--tunnel-dst </b><i>addr[/mask]</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches the destination end-point address of a tunnel mode SA.
Only valid with --mode tunnel.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--next</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Start the next element in the policy specification. Can only be used with
--strict
</td></tr>
</table>
<h2><i>random</i></h2>
This module randomly matches a certain percentage of all packets.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--average </b><i>percent</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Matches the given percentage.  If omitted, a probability of 50% is set.
</td></tr>
</table>
<h2><i>rt</i></h2>
Match on IPv6 routing header
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--rt-type</b> [!] <i>type</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Match the type (numeric).
</td></tr>
<tr valign="top"><td colspan="2">
<b>--rt-segsleft</b> [!] <i>num</i>[:<i>num</i>] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Match the &#145;segments left&#146; field (range).
</td></tr>
<tr valign="top"><td colspan="2">
<b>--rt-len</b> [!] <i>length</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Match the length of this header.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--rt-0-res</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Match the reserved field, too (type=0)
</td></tr>
<tr valign="top"><td colspan="2">
<b>--rt-0-addrs</b> <i>ADDR</i>[,<i>ADDR</i>...] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Match type=0 addresses (list).
</td></tr>
<tr valign="top"><td colspan="2">
<b>--rt-0-not-strict</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
List of type=0 addresses is not a strict list.
</td></tr>
</table>
<h2><i>tcp</i></h2>
These extensions are loaded if &#145;--protocol tcp&#146; is specified. It
provides the following options:
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--source-port </b>[!] <i>port</i>[:<i>port</i>] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Source port or port range specification. This can either be a service
name or a port number. An inclusive range can also be specified,
using the format
<i>port</i>:<i>port</i>. If the first port is omitted, "0" is assumed; if the last is omitted,
"65535" is assumed.
If the second port greater then the first they will be swapped.
The flag
<b>--sport</b> is a convenient alias for this option.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--destination-port </b>[!] <i>port</i>[:<i>port</i>] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Destination port or port range specification.  The flag
<b>--dport</b> is a convenient alias for this option.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--tcp-flags </b>[!] <i>mask</i> <i>comp</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Match when the TCP flags are as specified.  The first argument is the
flags which we should examine, written as a comma-separated list, and
the second argument is a comma-separated list of flags which must be
set.  Flags are:
<b>SYN ACK FIN RST URG PSH ALL NONE</b>. Hence the command
<table class="src" cellpadding="5" cellspacing="5">
<tr><td><pre>
 ip6tables -A FORWARD -p tcp --tcp-flags SYN,ACK,FIN,RST SYN
</pre></td></tr>
</table>
will only match packets with the SYN flag set, and the ACK, FIN and
RST flags unset.
</td></tr>
<tr valign="top"><td colspan="2">
<b>[!] --syn</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Only match TCP packets with the SYN bit set and the ACK and RST bits
cleared.  Such packets are used to request TCP connection initiation;
for example, blocking such packets coming in an interface will prevent
incoming TCP connections, but outgoing TCP connections will be
unaffected.
It is equivalent to <b>--tcp-flags SYN,RST,ACK SYN</b>.
If the "!" flag precedes the "--syn", the sense of the
option is inverted.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--tcp-option </b>[!] <i>number</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Match if TCP option set.
</td></tr>
</table>
<h2><i>udp</i></h2>
These extensions are loaded if &#145;--protocol udp&#146; is specified.  It
provides the following options:
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--source-port </b>[!] <i>port</i>[:<i>port</i>] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Source port or port range specification.
See the description of the
<b>--source-port</b> option of the TCP extension for details.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--destination-port </b>[!] <i>port</i>[:<i>port</i>] </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Destination port or port range specification.
See the description of the
<b>--destination-port</b> option of the TCP extension for details.
</td></tr>
</table>
<h1 class="manpages">TARGET EXTENSIONS</h1>
ip6tables can use extended target modules: the following are included
in the standard distribution.
<h2><i>DSCP</i></h2>
This target allows to alter the value of the DSCP bits within the TOS
header of the IPv4 packet.  As this manipulates a packet, it can only
be used in the mangle table.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--set-dscp </b><i>value</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Set the DSCP field to a numerical value (can be decimal or hex)
</td></tr>
<tr valign="top"><td colspan="2">
<b>--set-dscp-class </b><i>class</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Set the DSCP field to a DiffServ class.
</td></tr>
</table>
<h2><i>HL</i></h2>
This is used to modify the Hop Limit field in IPv6 header. The Hop Limit field
is similar to what is known as TTL value in IPv4.  Setting or incrementing the
Hop Limit field can potentially be very dangerous, so it should be avoided at
any cost. This target is only valid in
<b>mangle</b> table.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>Don&#146;t ever set or increment the value on packets that leave your local network!</b> <!-- Consumed .TP -->
<br />
<b>--hl-set </b><i>value</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Set the Hop Limit to &#145;value&#146;.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--hl-dec </b><i>value</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Decrement the Hop Limit &#145;value&#146; times.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--hl-inc </b><i>value</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Increment the Hop Limit &#145;value&#146; times.
</td></tr>
</table>
<h2><i>LOG</i></h2>
Turn on kernel logging of matching packets.  When this option is set
for a rule, the Linux kernel will print some information on all
matching packets (like most IPv6 IPv6-header fields) via the kernel log
(where it can be read with
<i>dmesg</i> or
<b>syslogd</b>(8)).
This is a "non-terminating target", i.e. rule traversal continues at
the next rule.  So if you want to LOG the packets you refuse, use two
separate rules with the same matching criteria, first using target LOG
then DROP (or REJECT).
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--log-level </b><i>level</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Level of logging (numeric or see <i>syslog.conf</i>(5)).
</td></tr>
<tr valign="top"><td colspan="2">
<b>--log-prefix </b><i>prefix</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Prefix log messages with the specified prefix; up to 29 letters long,
and useful for distinguishing messages in the logs.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--log-tcp-sequence</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Log TCP sequence numbers. This is a security risk if the log is
readable by users.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--log-tcp-options</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Log options from the TCP packet header.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--log-ip-options</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Log options from the IPv6 packet header.
</td></tr>
<tr valign="top"><td colspan="2">
<b>--log-uid</b> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
Log the userid of the process which generated the packet.
</td></tr>
</table>
<h2><i>MARK</i></h2>
This is used to set the netfilter mark value associated with the
packet.  It is only valid in the
<b>mangle</b> table.
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--set-mark </b><i>mark</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
</td></tr>
</table>
<h2><i>NFQUEUE</i></h2>
This target is an extension of the QUEUE target. As opposed to QUEUE, it allows
you to put a packet into any specific queue, identified by its 16-bit queue
number. 
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--queue-num </b><i>value</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
This specifies the QUEUE number to use. Valud queue numbers are 0 to 65535. The default value is 0.
</td></tr>
<tr valign="top"><td colspan="2">
It can only be used with Kernel versions 2.6.14 or later, since it requires
</td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
the
<b></b> nfnetlink_queue
kernel support.
</td></tr>
</table>
<h2><i>REJECT</i></h2>
This is used to send back an error packet in response to the matched
packet: otherwise it is equivalent to
<b>DROP</b> so it is a terminating TARGET, ending rule traversal.
This target is only valid in the
<b>INPUT</b>, <b>FORWARD</b> and
<b>OUTPUT</b> chains, and user-defined chains which are only called from those
chains.  The following option controls the nature of the error packet
returned:
<table class="src" cellpadding="5" cellspacing="0" border="1">
<tr><th width="25%">Tag</th><th>Description</th></tr>
<tr valign="top"><td colspan="2">
<b>--reject-with </b><i>type</i> </td></tr><tr valign="top"><td width=6%>&nbsp;</td><td>
The type given can be
<table class="src" cellpadding="5" cellspacing="5">
<tr><td><pre>
<b> icmp6-no-route</b> 
<b> no-route</b> 
<b> icmp6-adm-prohibited</b> 
<b> adm-prohibited</b> 
<b> icmp6-addr-unreachable</b> 
<b> addr-unreach</b> 
<b> icmp6-port-unreachable</b> 
<b> port-unreach</b> 
</pre></td></tr>
</table>
which return the appropriate ICMPv6 error message (<b>port-unreach</b> is
the default). Finally, the option
<b>tcp-reset</b> can be used on rules which only match the TCP protocol: this causes a
TCP RST packet to be sent back.  This is mainly useful for blocking
<i>ident</i> (113/tcp) probes which frequently occur when sending mail to broken mail
hosts (which won&#146;t accept your mail otherwise).
<b>tcp-reset</b> can only be used with kernel versions 2.6.14 or latter.
<p>
</td></tr>
</table>
<h2><i>TRACE</i></h2>
This target has no options.  It just turns on
<b>packet tracing</b> for all packets that match this rule.
<h1 class="manpages">DIAGNOSTICS</h1>
Various error messages are printed to standard error.  The exit code
is 0 for correct functioning.  Errors which appear to be caused by
invalid or abused command line parameters cause an exit code of 2, and
other errors cause an exit code of 1.
<h1 class="manpages">BUGS</h1>
Bugs?  What&#146;s this? ;-)
Well... the counters are not reliable on sparc64.
<h1 class="manpages">COMPATIBILITY WITH IPCHAINS</h1>
This
<b>ip6tables</b> is very similar to ipchains by Rusty Russell.  The main difference is
that the chains
<b>INPUT</b> and
<b>OUTPUT</b> are only traversed for packets coming into the local host and
originating from the local host respectively.  Hence every packet only
passes through one of the three chains (except loopback traffic, which
involves both INPUT and OUTPUT chains); previously a forwarded packet
would pass through all three.
<p>
The other main difference is that
<b>-i</b> refers to the input interface;
<b>-o</b> refers to the output interface, and both are available for packets
entering the
<b>FORWARD</b> chain.
There are several other changes in ip6tables.
<h1 class="manpages">SEE ALSO</h1>
<ul>
<li><p><a href="ip6tables.htm">ip6tables (8)</a></p></li>
<li><p><a href="ip6tables.htm">ip6tables (8)</a></p></li>
<li><p><a href="iptables.htm">iptables (8)</a></p></li>
<li><p><a href="iptables.htm">iptables (8)</a></p></li>
<li><p><a href="iptables.htm">iptables (8)</a></p></li>
</ul>
The packet-filtering-HOWTO details iptables usage for
packet filtering, the NAT-HOWTO details NAT,
the netfilter-extensions-HOWTO details the extensions that are
not in the standard distribution,
and the netfilter-hacking-HOWTO details the netfilter internals.
<!-- Need break --><br />
See
<b><a href="http://www.netfilter.org/">http://www.netfilter.org</a>/</b>. <h1 class="manpages">AUTHORS</h1>
Rusty Russell wrote iptables, in early consultation with Michael
Neuling.
<p>
Marc Boucher made Rusty abandon ipnatctl by lobbying for a generic packet
selection framework in iptables, then wrote the mangle table, the owner match,
the mark stuff, and ran around doing cool stuff everywhere.
<p>
James Morris wrote the TOS target, and tos match.
<p>
Jozsef Kadlecsik wrote the REJECT target.
<p>
Harald Welte wrote the ULOG and NFQUEUE target, the new libiptc, aswell as TTL match+target and libipulog.
<p>
The Netfilter Core Team is: Marc Boucher, Martin Josefsson, Jozsef Kadlecsik,
James Morris, Harald Welte and Rusty Russell.
<p>
ip6tables man page created by Andras Kis-Szabo, based on
iptables man page written by Herve Eychenne &lt;<a href="mailto:rv@wallfire.org">rv@wallfire.org</a>&gt;.
<br />
<hr />
<a href="index.html"><img alt="previous" border="0" src="../images/previous.gif" /></a>
<a href="index.html"><img alt="next" border="0" src="../images/next.gif" /></a>
<a href='../cgi-bin/printversion17ad.html?tutorial=unix_commands&amp;file=ip6tables.htm' target="_blank">
<img src="../images/print.gif" alt="Printer Friendly" border="0" /></a>
<br />
<hr />
<!-- PRINTING ENDS HERE -->
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 336;
google_ad_height = 280;
google_ad_format = "336x280_as";
google_ad_type = "text_image";
google_ad_channel ="9030538898";
google_color_border="ffffff";
google_color_link="900b09";
google_color_url="000000";
google_color_text="000000";
//--></script>
<script type="text/javascript" src="../../pagead2.googlesyndication.com/pagead/show_ads.js"></script>
</td></tr>
</table>
</td>
<td class="right" align="center" valign="top">
<br /><br />
<table width="100%" cellpadding="0" cellspacing="0">
<tr valign="middle">
<td  class="top" style="border:0px;">
&nbsp;&nbsp;
</td>
</tr>
</table>
<table class="right"  cellpadding="0" cellspacing="0">
<tr>
<td align="center" class="right">
<p>
<u>Advertisements</u>
</p>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<br /><br /></td></tr></table>
</td></tr></table>
</center>
</body>

<!-- Mirrored from www.tutorialspoint.com/unix_commands/ip6tables.htm by HTTrack Website Copier/3.x [XR&CO'2010], Mon, 15 Apr 2013 05:04:48 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
</html>
