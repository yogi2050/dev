<!doctype html> 
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]> <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]> <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]> <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--><html lang="en"><!--<![endif]-->

<!-- Mirrored from www.tutorialspoint.com/ruby/ruby_dbi_fetching_results.htm by HTTrack Website Copier/3.x [XR&CO'2010], Mon, 15 Apr 2013 05:03:06 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8">
<title>Ruby - DBI Methods for Read Operation</title>
<link rel="shortcut icon" href="../favicon.png" type="image/x-icon" />
<meta name="Keywords" content="Ruby, Tutorials, Learning, Beginners, Basics, Scripting Language, Syntax, Classes, , Variables, Comments, Loops, File, I/O, Functions, Objects, TK, Ranges, iterators, arrays, strings, methods, blocks, Exception, Multi-Threading, Hashes, Modules, LDAP, Web Services, Web Programming." />
<meta name="description" content="DBI Methods for Read Operation - Learning Ruby in simple and easy steps - A beginner's tutorial containing complete knowledge of Ruby Syntax Syntax, Classes, , Variables, Comments, Loops, File, I/O, Functions, Objects, TK, Ranges, iterators, arrays, strings, methods, blocks, Exception, Multi-Threading, Hashes, Modules, LDAP, Web Services, Web Programming." />
<base  />
<link rel="stylesheet" type="text/css" href="../scripts/style.css" />
<link rel="stylesheet" type="text/css" href="../scripts/prettify.css" />
<script type="text/javascript" src="../scripts/prettify.js"></script>
<style media="screen" type="text/css">
/* Ruby Scheme */
#topmenu a:link {text-decoration:none;color:#fff !important;background-color:transparent;font-weight:bold;}
#topmenu a:visited {text-decoration:none;color:#fff !important;background-color:transparent;font-weight:bold;}
#topmenu a:hover {text-decoration:none;color:#C83932 !important;background-color:transparent;font-weight:bold;}
#header{ 
background:#C83932 !important;
}
#topmenu
{
background-color:#5E0500 !important;
}
#leftcol ul.menu li.heading 
{
background:#C83932 !important;
border:1px solid #964800 !important;
}
#leftcol, #middlecol, #rightcol {min-height:1500px; padding:0px;}
</style>
<script src="../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-232293-6";
urchinTracker();
</script>
</head>
<body onload="prettyPrint()">
<div id="header">
<div class="wrapper">
<h1 class="logo"><a href="../index-2.html">Tutorials Point - Simply Easy Learning</a></h1>
<div id="search">
<form method="get" id="searchform" name="searchform" action="http://www.google.com/search" target="_blank">
<input type="hidden" name="sitesearch" value="www.tutorialspoint.com"/>
<input type="text" name="as_q" id="s" value="Search this site..." onfocus="if (this.value == 'Search this site...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search this site...';}"/>
<input value="FORID:11" name="cof" type="hidden"/>
<input type="hidden" name="ie" value="ISO-8859-1" />
<input class="submit btn" type="image" src="../images/icon-search.png" alt="Go"/>
</form>
</div>
</div>
</div>
<div id="topmenu">
<div class="wrapper">
<div id="left">
<a href="../index-2.html" target="_top">HOME </a>
<a href="../java/index.html" target="_top">JAVA </a>
<a href="../php/index.html" target="_top">PHP </a>
<a href="../python/index.html" target="_top">Python </a>
<a href="index.html" target="_top">Ruby </a>
<a href="../perl/index.html" target="_top">Perl </a>
<a href="../html/index.html" target="_top">HTML </a>
<a href="../css/index.html" target="_top">CSS </a>
<a href="../javascript/index.html" target="_top">Javascript </a>
<a href="../mysql/index.html" target="_top">MySQL </a>
<a href="../cplusplus/index.html" target="_top">C++ </a>
<a href="../unix/index.html" target="_top">UNIX </a>
<a href="../more.html" target="_top">MORE...</a>
</div>
<div id="right">
<a href="../references.html" target="_top">REFERENCES</a> |
<a href="../forums/index.html" target="_top">FORUM</a> |
<a href="../about/index.html" target="_top">ABOUT</a> |
<a href="../about/contact_us.html" target="_top">CONTACT</a>
</div>
</div>
</div>
<div class="wrapper">
<div id="leftcol">
<div class="mini-logo">
<img src="../images/ruby-mini-logo.png" alt="Ruby Tutorial" />
</div>
<ul class="menu">
<li class="heading">Ruby Basics</li>
<li><a class="left" target="_top" href="index.html">Ruby Home</a></li>
<li><a class="left" target="_top" href="ruby_overview.html">Ruby Overview</a></li>
<li><a class="left" target="_top" href="ruby_environment.html">Ruby Environment</a></li>
<li><a class="left" target="_top" href="ruby_syntax.html">Ruby Syntax</a></li>
<li><a class="left" target="_top" href="ruby_classes.html">Ruby Classes</a></li>
<li><a class="left" target="_top" href="ruby_variables.html">Ruby Variables</a></li>
<li><a class="left" target="_top" href="ruby_operators.html">Ruby Operators</a></li>
<li><a class="left" target="_top" href="ruby_comments.html">Ruby Comments</a></li>
<li><a class="left" target="_top" href="ruby_if_else.html">Ruby IF...ELSE</a></li>
<li><a class="left" target="_top" href="ruby_loops.html">Ruby Loops</a></li>
<li><a class="left" target="_top" href="ruby_methods.html">Ruby Methods</a></li>
<li><a class="left" target="_top" href="ruby_blocks.html">Ruby Blocks</a></li>
<li><a class="left" target="_top" href="ruby_modules.html">Ruby Modules</a></li>
<li><a class="left" target="_top" href="ruby_strings.html">Ruby Strings</a></li>
<li><a class="left" target="_top" href="ruby_arrays.html">Ruby Arrays</a></li>
<li><a class="left" target="_top" href="ruby_hashes.html">Ruby Hashes</a></li>
<li><a class="left" target="_top" href="ruby_date_time.html">Ruby Date &amp; Time</a></li>
<li><a class="left" target="_top" href="ruby_ranges.html">Ruby Ranges</a></li>
<li><a class="left" target="_top" href="ruby_iterators.html">Ruby Iterators</a></li>
<li><a class="left" target="_top" href="ruby_input_output.html">Ruby File I/O</a></li>
<li><a class="left" target="_top" href="ruby_exceptions.html">Ruby Exceptions</a></li>
</ul>
<ul class="menu">
<li class="heading">Ruby Advanced</li>
<li><a class="left" target="_top" href="ruby_object_oriented.html">Ruby Object Oriented</a></li>
<li><a class="left" target="_top" href="ruby_regular_expressions.html">Ruby Regular Expressions</a></li>
<li><a class="left" target="_top" href="ruby_database_access.html"><b>Ruby Database Access</b></a></li>
<li><a class="left" target="_top" href="ruby_web_applications.html">Ruby Web Applications</a></li>
<li><a class="left" target="_top" href="ruby_sending_email.html">Ruby Sending Email</a></li>
<li><a class="left" target="_top" href="ruby_socket_programming.html">Ruby Socket Programming</a></li>
<li><a class="left" target="_top" href="ruby_xml_xslt.html">Ruby/XML, XSLT</a></li>
<li><a class="left" target="_top" href="ruby_web_services.html">Ruby Web Services</a></li>
<li><a class="left" target="_top" href="ruby_tk_guide.html">Ruby/Tk Guide</a></li>
<li><a class="left" target="_top" href="ruby_ldap.html">Ruby/LDAP Tutorial</a></li>
<li><a class="left" target="_top" href="ruby_multithreading.html">Ruby Multithreading</a></li>
</ul>
<ul class="menu">
<li class="heading">Ruby Useful Resources</li>
<li><a class="left" target="_top" href="ruby_quick_guide.html">Ruby Quick Guide</a></li>
<li><a class="left" target="_top" href="ruby_builtin_functions.html">Ruby Built-in Functions</a></li>
<li><a class="left" target="_top" href="ruby_predefined_variables.html">Ruby Predefined Variables</a></li>
<li><a class="left" target="_top" href="ruby_predefined_constants.html">Ruby Predefined Constants</a></li>
<li><a class="left" target="_top" href="ruby_associated_tools.html">Ruby Associated Tools</a></li>
<li><a class="left" target="_top" href="ruby_resources.html">Ruby Useful Resources</a></li>
<li><a class="left" target="_top" href="../ruby-on-rails/index.html">Ruby on Rails Tutorial</a></li>
</ul>
<ul class="menu">
<li class="sreading">Selected Reading</li>
<li><a target="_top" href="../developers_best_practices/index.html">Developer's Best Practices</a></li>
<li><a target="_top" href="../computer_glossary.html">Computer Glossary</a></li>
<li><a target="_top" href="../computer_whoiswho.html">Who is Who</a></li>
</ul>
</div><!-- leftcol -->
<div id="middlecol">
<!-- PRINTING STARTS HERE -->
<div class="content">
<h1>Ruby - DBI Methods for Read Operation</h1>
<div class="topgooglead">
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "image";
google_ad_channel = "";
//--></script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/show_ads.js"> 
</script>
</div>
<hr />
<div class="pre-btn">
<a href="ruby_database_access.html">Previous Page</a>
</div>
<div class="nxt-btn">
<a href="ruby_database_access.html">Next Page</a>
</div>
<div class="clearer"></div>
<hr />
<p>DBI provides several different methods to fetch records from the database. Assuming <b>dbh</b> is a database handle and <b>sth</b> is a statement handle:</p>
<table class="src">
<tr><th style="width:5%">S.N.</th><th>Methods with Description</th></tr>
<tr><td>1</td><td><b>db.select_one( stmt, *bindvars ) => aRow | nil</b><br /> Executes the <i>stmt</i> statement with the <i>bindvars</i> binding beforehand to parameter markers. Returns the first row or <i>nil</i> if the result-set is empty.</td></tr>
<tr><td>2</td><td><b>db.select_all( stmt, *bindvars ) => [aRow, ...] | nil<br /><br />db.select_all( stmt, *bindvars ){ |aRow| aBlock }</b><br /> Executes the <i>stmt</i> statement with the <i>bindvars</i> binding beforehand to parameter markers. Calling this method without block returns an array containing all rows. If a block is given, this will be called for each row.</td></tr>
<tr><td>3</td><td><b>sth.fetch => aRow | nil</b><br /> Returns the <i>next</i> row. Returns <i>nil</i> if no further rows are in the result-set.</td></tr>
<tr><td>4</td><td><b>sth.fetch { |aRow| aBlock }</b><br /> Invokes the given block for the remaining rows
of the result-set.</td></tr>
<tr><td>5</td><td><b>sth.fetch_all => [aRow, ...]</b><br /> Returns all remaining rows of the result-set collected
in an array.</td></tr>
<tr><td>6</td><td><b>sth.fetch_many( count ) => [aRow, ...]</b><br /> Returns the next <i>count</i> rows collected in an
[aRow, ...] array.</td></tr>
<tr><td>7</td><td><b>sth.fetch_scroll( direction, offset=1 ) => aRow | nil</b><br /> Returns the row specified by the <i>direction</i> parameter	and <i>offset</i>. Parameter <i>offset</i> is discarded for all but SQL_FETCH_ABSOLUTE
and SQL_FETCH_RELATIVE. See a table below for possible values of <i>direction</i> parameter.</td></tr>
<tr><td>8</td><td><b>sth.column_names => anArray</b><br />Returns the names of the columns.</td></tr>
<tr><td>9</td><td><b>column_info => [ aColumnInfo, ... ]</b><br />Returns an array of DBI::ColumnInfo objects. Each object stores information about one column and contains its name, type, precision and more.</td></tr>
<tr><td>10</td><td><b>sth.rows => rpc</b><br /> Returns the Row Processed <i>Count</i> of the
executed statement or <i>nil</i> if no such exist.</td></tr>
<tr><td>11</td><td><b>sth.fetchable? => true | false</b><br /> Returns <i>true</i> if it's possible to fetch rows,
otherwise <i>false</i>.</td></tr>
<tr><td>12</td><td><b>sth.cancel</b><br /> Frees the resources held by the result-set. After calling this method, it is no longer
possible to fetch rows until you again call <i>execute</i>.</td></tr>
<tr><td>13</td><td><b>sth.finish</b><br /> Frees the resources held by the prepared statement. After calling this method no
further methods can be called onto this object.</td></tr>
</table>
<h2>The direction Parameter:</h2>
<p>Following values could be used for the direction Parameter of the <i>fetch_scroll</i> Method:</p>
<table class="src">
<tr><th>Constant</th><th>Description</th></tr>
<tr><td>DBI::SQL_FETCH_FIRST</td><td>Fetch first row.</td></tr>
<tr><td>DBI::SQL_FETCH_LAST</td><td>Fetch last row.</td></tr>
<tr><td>DBI::SQL_FETCH_NEXT</td><td>Fetch next row.</td></tr>
<tr><td>DBI::SQL_FETCH_PRIOR</td><td>Fetch previous row.</td></tr>
<tr><td>DBI::SQL_FETCH_ABSOLUTE</td><td>Fetch row at position offset.</td></tr>
<tr><td>DBI::SQL_FETCH_RELATIVE</td><td>Fetch the row that is offset rows away from
the current.</td></tr>
</table>
<h2>Example:</h2>
<p>The following example shows how to get metadata for a statement. Consider EMPLOYEE table which we created in last chapter.</p>
<pre class="prettyprint">
#!/usr/bin/ruby -w

require "dbi"

begin
     # connect to the MySQL server
     dbh = DBI.connect("DBI:Mysql:TESTDB:localhost", 
	                    "testuser", "test123")
     sth = dbh.prepare("SELECT * FROM EMPLOYEE 
	                    WHERE INCOME &gt; ?")
     sth.execute(1000)
     if sth.column_names.size == 0 then
        puts "Statement has no result set"
        printf "Number of rows affected: %d\n", sth.rows
     else
        puts "Statement has a result set"
        rows = sth.fetch_all
        printf "Number of rows: %d\n", rows.size
        printf "Number of columns: %d\n", sth.column_names.size
        sth.column_info.each_with_index do |info, i|
          printf "--- Column %d (%s) ---\n", i, info["name"]
          printf "sql_type:         %s\n", info["sql_type"]
          printf "type_name:        %s\n", info["type_name"]
          printf "precision:        %s\n", info["precision"]
          printf "scale:            %s\n", info["scale"]
          printf "nullable:         %s\n", info["nullable"]
          printf "indexed:          %s\n", info["indexed"]
          printf "primary:          %s\n", info["primary"]
          printf "unique:           %s\n", info["unique"]
          printf "mysql_type:       %s\n", info["mysql_type"]
          printf "mysql_type_name:  %s\n", info["mysql_type_name"]
          printf "mysql_length:     %s\n", info["mysql_length"]
          printf "mysql_max_length: %s\n", info["mysql_max_length"]
          printf "mysql_flags:      %s\n", info["mysql_flags"]
      end
   end
   sth.finish
rescue DBI::DatabaseError =&gt; e
     puts "An error occurred"
     puts "Error code:    #{e.err}"
     puts "Error message: #{e.errstr}"
ensure
     # disconnect from server
     dbh.disconnect if dbh
end
</pre>
<p>This will produce following result:</p>
<pre class="prettyprint">
Statement has a result set
Number of rows: 5
Number of columns: 5
--- Column 0 (FIRST_NAME) ---
sql_type:         12
type_name:        VARCHAR
precision:        20
scale:            0
nullable:         true
indexed:          false
primary:          false
unique:           false
mysql_type:       254
mysql_type_name:  VARCHAR
mysql_length:     20
mysql_max_length: 4
mysql_flags:      0
--- Column 1 (LAST_NAME) ---
sql_type:         12
type_name:        VARCHAR
precision:        20
scale:            0
nullable:         true
indexed:          false
primary:          false
unique:           false
mysql_type:       254
mysql_type_name:  VARCHAR
mysql_length:     20
mysql_max_length: 5
mysql_flags:      0
--- Column 2 (AGE) ---
sql_type:         4
type_name:        INTEGER
precision:        11
scale:            0
nullable:         true
indexed:          false
primary:          false
unique:           false
mysql_type:       3
mysql_type_name:  INT
mysql_length:     11
mysql_max_length: 2
mysql_flags:      32768
--- Column 3 (SEX) ---
sql_type:         12
type_name:        VARCHAR
precision:        1
scale:            0
nullable:         true
indexed:          false
primary:          false
unique:           false
mysql_type:       254
mysql_type_name:  VARCHAR
mysql_length:     1
mysql_max_length: 1
mysql_flags:      0
--- Column 4 (INCOME) ---
sql_type:         6
type_name:        FLOAT
precision:        12
scale:            31
nullable:         true
indexed:          false
primary:          false
unique:           false
mysql_type:       4
mysql_type_name:  FLOAT
mysql_length:     12
mysql_max_length: 4
mysql_flags:      32768
</pre>
<hr />
<div class="pre-btn">
<a href="ruby_database_access.html">Previous Page</a>
</div>
<div class="print-btn">
<a href="../cgi-bin/printpage.html" target="_blank">Print Version</a>
</div>
<div class="pdf-btn">
<a href="pdf/ruby_dbi_fetching_results.html" alt="Ruby - DBI Methods for Read Operation" target="_blank">PDF Version</a>
</div>
<div class="nxt-btn">
<a href="ruby_database_access.html">Next Page</a>
</div>
<div class="clearer"></div>
<hr />
</div>
<!-- PRINTING ENDS HERE -->
<div class="bottomgooglead">
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 336;
google_ad_height = 280;
google_ad_format = "336x280_as";
google_ad_type = "text";
google_ad_channel ="9030538898";
google_color_border="ffffff";
google_color_link="900b09";
google_color_url="000000";
google_color_text="000000";
//--></script>
<script type="text/javascript" src="../../pagead2.googlesyndication.com/pagead/show_ads.js"></script>
</div>
</div><!-- middlecol -->
<div id="rightcol">
<!-- AddThis Button BEGIN -->
<div class="addthis">
<div class="addthis_toolbox addthis_default_style">
<a class="addthis_button_facebook"></a>
<a class="addthis_button_twitter"></a>
<script type="text/javascript">
<!--
 document.write('<a class="addthis_button_google_plusone" g:plusone:count="false"></a>');
//-->
</script>
<a class="addthis_button_linkedin"></a>
<a class="addthis_button_email"></a>
<a class="addthis_button_compact"></a>
</div>
<script type="text/javascript" src="../../s7.addthis.com/js/250/addthis_widget.js#pubid=ra-4f661ec623a400f0"></script>
</div>
<!-- AddThis Button END -->
<div class="localad">
<a rel="nofollow" href="http://www.modernindianbabynames.com/" target="_blank" title="Modern Baby Names">Modern Baby Names</a>
</div>
<div class="localad">
<a rel="nofollow" href="http://www.photofuntoos.com/" target="_blank" title="Online Photo Editing">Online Photo Editing</a>
</div>
<div class="rightgooglead">
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/show_ads.js"> 
</script>
</div>
</div><!-- rightcol -->
<div style="clear:both;"></div>
</div><!-- wrapper -->
<div id="footer">
<div class="wrapper">
<div id="bottommenu">
<a href="../asp.net/index.html" target="_top">ASP.NET </a> |
<a href="../jquery/index.html" target="_top">jQuery </a> |
<a href="../ajax/index.html" target="_top">AJAX </a> |
<a href="../ant/index.html" target="_top">ANT</a> |
<a href="../jsp/index.html" target="_top">JSP </a> |
<a href="../servlets/index.html" target="_top">Servlets </a> |
<a href="../log4j/index.html" target="_top">log4j </a> |
<a href="../ibatis/index.html" target="_top">iBATIS </a> |
<a href="../hibernate/index.html" target="_top">Hibernate </a> |
<a href="../jdbc/index.html" target="_top">JDBC </a> |
<a href="../struts_2/index.html" target="_top">Struts </a> |
<a href="../html5/index.html" target="_top">HTML5 </a> |
<a href="../sql/index.html" target="_top">SQL </a> |
<a href="../mysql/index.html" target="_top">MySQL </a> |
<a href="../cplusplus/index.html" target="_top">C++ </a> |
<a href="../unix/index.html" target="_top">UNIX </a>
</div>
<div id="copyright">
<p>Copyright &copy; 2013 by tutorialspoint. All Rights Reserved.</p>
</div>
</div>
</div>
</body>

<!-- Mirrored from www.tutorialspoint.com/ruby/ruby_dbi_fetching_results.htm by HTTrack Website Copier/3.x [XR&CO'2010], Mon, 15 Apr 2013 05:03:06 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
</html>