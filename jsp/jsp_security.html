<!doctype html> 
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]> <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]> <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]> <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--><html lang="en"><!--<![endif]-->

<!-- Mirrored from www.tutorialspoint.com/jsp/jsp_security.htm by HTTrack Website Copier/3.x [XR&CO'2010], Sun, 14 Apr 2013 19:40:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8">
<title>JSP - Security</title>
<link rel="shortcut icon" href="../favicon.png" type="image/x-icon" />
<meta name="description" content="JSP, Tutorials, Learning, Beginners, Basics, Environment, Life Cycle, Examples, Client Request, Server Response, Http Codes, Writing Filters, Exceptions, Cookies, Sessions, Database Access, File Uploading, File Uploading, Internationalization." />
<meta name="keywords" content="JSP Security - Learning JSP (Java Server Pages) in simple and easy steps using this beginner's tutorial containing basic to advanced knowledge of Java JSP Technology including Form Data, HTTP Request Header, Response Header, Status Codes, Cookies Handling and Session Tracking." />
<base  />
<link rel="stylesheet" type="text/css" href="../scripts/style.css" />
<link rel="stylesheet" type="text/css" href="../scripts/prettify.css" />
<script type="text/javascript" src="../scripts/prettify.js"></script>
<style media="screen" type="text/css">
#topmenu a:hover {text-decoration:none;color:#00afe4 !important;background-color:transparent;font-weight:bold;}
#header{ 
background:#00afe4  !important;
}
#topmenu
{
background-color:#113e78 !important;
}
#leftcol ul.menu li.heading 
{
background:#00afe4 !important;
border:1px solid #113e78  !important;
}
#leftcol, #middlecol, #rightcol {min-height:1275px; padding:0px;}
</style>
<script src="../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-232293-6";
urchinTracker();
</script>
</head>
<body onload="prettyPrint()">
<div id="header">
<div class="wrapper">
<h1 class="logo"><a href="../index-2.html">Tutorials Point - Simply Easy Learning</a></h1>
<div id="search">
<form method="get" id="searchform" name="searchform" action="http://www.google.com/search" target="_blank">
<input type="hidden" name="sitesearch" value="www.tutorialspoint.com"/>
<input type="text" name="as_q" id="s" value="Search this site..." onfocus="if (this.value == 'Search this site...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search this site...';}"/>
<input value="FORID:11" name="cof" type="hidden"/>
<input type="hidden" name="ie" value="ISO-8859-1" />
<input class="submit btn" type="image" src="../images/icon-search.png" alt="Go"/>
</form>
</div>
</div>
</div>
<div id="topmenu">
<div class="wrapper">
<div id="left">
<a href="../index-2.html" target="_top">HOME </a>
<a href="../java/index.html" target="_top">JAVA </a>
<a href="../php/index.html" target="_top">PHP </a>
<a href="../python/index.html" target="_top">Python </a>
<a href="../ruby/index.html" target="_top">Ruby </a>
<a href="../perl/index.html" target="_top">Perl </a>
<a href="../html/index.html" target="_top">HTML </a>
<a href="../css/index.html" target="_top">CSS </a>
<a href="../javascript/index.html" target="_top">Javascript </a>
<a href="../mysql/index.html" target="_top">MySQL </a>
<a href="../cplusplus/index.html" target="_top">C++ </a>
<a href="../unix/index.html" target="_top">UNIX </a>
<a href="../more.html" target="_top">MORE...</a>
</div>
<div id="right">
<a href="../references.html" target="_top">REFERENCES</a> |
<a href="../forums/index.html" target="_top">FORUM</a> |
<a href="../about/index.html" target="_top">ABOUT</a> |
<a href="../about/contact_us.html" target="_top">CONTACT</a>
</div>
</div>
</div>
<div class="wrapper">
<div id="leftcol">
<div class="mini-logo">
<img src="../images/jsp-mini-logo.png" alt="JSP Tutorial" />
</div>
<ul class="menu">
<li class="heading">Basic JSP Tutorial</li>
<li><a target="_top" href="index.html">JSP - Home</a></li>
<li><a target="_top" href="jsp_overview.html">JSP - Overview</a></li>
<li><a target="_top" href="jsp_environment_setup.html">JSP - Environment</a></li>
<li><a target="_top" href="jsp_architecture.html">JSP - Architecture</a></li>
<li><a target="_top" href="jsp_life_cycle.html">JSP - Life Cycle</a></li>
<li><a target="_top" href="jsp_syntax.html">JSP - Syntax</a></li>
<li><a target="_top" href="jsp_directives.html">JSP - Directives</a></li>
<li><a target="_top" href="jsp_actions.html">JSP - Actions</a></li>
<li><a target="_top" href="jsp_implicit_objects.html">JSP - Implicit Objects</a></li>
<li><a target="_top" href="jsp_client_request.html">JSP - Client Request</a></li>
<li><a target="_top" href="jsp_server_response.html">JSP - Server Response</a></li>
<li><a target="_top" href="jsp_http_status_codes.html">JSP - Http Codes</a></li>
<li><a target="_top" href="jsp_form_processing.html">JSP - Form Processing</a></li>
<li><a target="_top" href="jsp_writing_filters.html">JSP - Writing Filters</a></li>
<li><a target="_top" href="jsp_cookies_handling.html">JSP - Cookies Handling</a></li>
<li><a target="_top" href="jsp_session_tracking.html">JSP - Session Tracking</a></li>
<li><a target="_top" href="jsp_file_uploading.html">JSP - File Uploading</a></li>
<li><a target="_top" href="jsp_handling_date.html">JSP - Handling Date</a></li>
<li><a target="_top" href="jsp_page_redirect.html">JSP - Page Redirect</a></li>
<li><a target="_top" href="jsp_hits_counter.html">JSP - Hits Counter</a></li>
<li><a target="_top" href="jsp_auto_refresh.html">JSP - Auto Refresh</a></li>
<li><a target="_top" href="jsp_sending_email.html">JSP - Sending Email</a></li>
</ul>
<ul class="menu">
<li class="heading">Advanced JSP Tutorials</li>
<li><a target="_top" href="jsp_standard_tag_library.html">JSP - Standard Tag Library</a></li>
<li><a target="_top" href="jsp_database_access.html">JSP - Database Access</a></li>
<li><a target="_top" href="jsp_xml_data.html">JSP - XML Data</a></li>
<li><a target="_top" href="jsp_java_beans.html">JSP - Java Beans</a></li>
<li><a target="_top" href="jsp_custom_tags.html">JSP - Custom Tags</a></li>
<li><a target="_top" href="jsp_expression_language.html">JSP - Expression Language</a></li>
<li><a target="_top" href="jsp_exception_handling.html">JSP - Exception Handling</a></li>
<li><a target="_top" href="jsp_debugging.html">JSP - Debugging</a></li>
<li><a target="_top" href="jsp_security.html"><b>JSP - Security</b></a></li>
<li><a target="_top" href="jsp_internationalization.html">JSP - Internationalization</a></li>
</ul>
<ul class="menu">
<li class="heading">JSP Useful Resources</li>
<li><a target="_top" href="jsp_quick_guide.html">JSP - Quick Guide</a></li>
<li><a target="_top" href="jsp_useful_resources.html">JSP Useful Resources</a></li>
</ul>
<ul class="menu">
<li class="sreading">Selected Reading</li>
<li><a target="_top" href="../developers_best_practices/index.html">Developer's Best Practices</a></li>
<li><a target="_top" href="../computer_glossary.html">Computer Glossary</a></li>
<li><a target="_top" href="../computer_whoiswho.html">Who is Who</a></li>
</ul>
</div><!-- leftcol -->
<div id="middlecol">
<!-- PRINTING STARTS HERE -->
<div class="content">
<h1>JSP - Security</h1>
<div class="topgooglead">
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "image";
google_ad_channel = "";
//--></script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/show_ads.js"> 
</script>
</div>
<hr />
<div class="pre-btn">
<a href="jsp_debugging.html">Previous Page</a>
</div>
<div class="nxt-btn">
<a href="jsp_internationalization.html">Next Page</a>
</div>
<div class="clearer"></div>
<hr />
<p>JavaServer Pages and servlets make several mechanisms available to Web developers to secure applications. Resources are protected declaratively by identifying them in the application deployment
descriptor and assigning a role to them.</p>
<p>Several levels of authentication are available, ranging from basic authentication using identifiers and passwords to sophisticated authentication using certificates.</p>
<h2>Role Based Authentication:</h2>
<p>The authentication mechanism in the servlet specification uses a technique called role-based security. The idea is that rather than restricting resources at the user level, you create roles and restrict the resources by role.</p>
<p>You can define different roles in file tomcat-users.xml, which is located off of Tomcat's home directory in conf. An example of this file is shown below:</p>
<pre class="prettyprint">
&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;tomcat-users&gt;
&lt;role rolename="tomcat"/&gt;
&lt;role rolename="role1"/&gt;
&lt;role rolename="manager"/&gt;
&lt;role rolename="admin"/&gt;
&lt;user username="tomcat" password="tomcat" roles="tomcat"/&gt;
&lt;user username="role1" password="tomcat" roles="role1"/&gt;
&lt;user username="both" password="tomcat" roles="tomcat,role1"/&gt;
&lt;user username="admin" password="secret" roles="admin,manager"/&gt;
&lt;/tomcat-users&gt;
</pre>
<p>This file defines a simple mapping between user name, password, and role. Notice that a given user may have multiple roles, for example, user name="both" is in the "tomcat" role and the "role1" role.</p>
<p>Once you identified and defined different roles, a role-based security restrictions can be placed on different Web Application resources by using the <b>&lt;security-constraint&gt;</b> element in web.xml file available in WEB-INF directory.</p>
<p>Following is a sample entry in web.xml:</p>
<pre class="prettyprint">
&lt;web-app&gt;
...
    &lt;security-constraint&gt;
        &lt;web-resource-collection&gt;
            &lt;web-resource-name&gt;
               SecuredBookSite
            &lt;/web-resource-name&gt;
            &lt;url-pattern&gt;/secured/*&lt;/url-pattern&gt;
            &lt;http-method&gt;GET&lt;/http-method&gt;
            &lt;http-method&gt;POST&lt;/http-method&gt;
        &lt;/web-resource-collection&gt;
        &lt;auth-constraint&gt;
            &lt;description&gt;
            Let only managers use this app
            &lt;/description&gt;
            &lt;role-name&gt;manager&lt;/role-name&gt;
        &lt;/auth-constraint&gt;
    &lt;/security-constraint&gt;
    &lt;security-role&gt;
  	   &lt;role-name&gt;manager&lt;/role-name&gt;
    &lt;/security-role&gt;
    &lt;login-config&gt;
      &lt;auth-method&gt;BASIC&lt;/auth-method&gt;
    &lt;/login-config&gt;
...
&lt;/web-app&gt;
</pre>
<p>Above entries would mean:</p>
<ul class="list">
<li><p>Any HTTP GET or POST request to a URL matched by /secured/* would be subject to the security restriction.</p></li>
<li><p>A person with manager role is given access to the secured resources.</p></li>
<li><p>Last, the login-config element is used to describe the BASIC form of authentication.</p></li>
</ul>
<p>Now if you try browsing to any URL including the /security directory, it would display  a dialogue box asking for user name and password. If you provide a user "admin" and password "secrer" then only you would have access on URL matched by /secured/* because above we have defined user admin with manager role who is allowed to access this resource.</p>
<h2>Form Based Authentication:</h2>
<p>When you use the FORM authentication method, you must supply a login form to prompt the user for a username and password. Following is a simple code of login.jsp to create a form for the same purpose:</p>
<pre class="prettyprint">
&lt;html&gt;
&lt;body bgcolor="#ffffff"&gt;
   &lt;form method="POST" action="j_security_check"&gt;
      &lt;table border="0"&gt;
      &lt;tr&gt;
      &lt;td&gt;Login&lt;/td&gt;
      &lt;td&gt;&lt;input type="text" name="j_username"&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
      &lt;td&gt;Password&lt;/td&gt;
      &lt;td&gt;&lt;input type="password" name="j_password"&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;/table&gt;
      &lt;input type="submit" value="Login!"&gt;
      &lt;/center&gt;
   &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
 </pre>
<p>Here you have to make sure that the login form must contain form elements named j_username and j_password. The action in the &lt;form&gt; tag must be j_security_check. POST must be used as the form method. Same time you would have to modify &lt;login-config&gt; tag to specify auth-method as FORM:</p>
<pre class="prettyprint">
&lt;web-app&gt;
...
    &lt;security-constraint&gt;
        &lt;web-resource-collection&gt;
            &lt;web-resource-name&gt;
               SecuredBookSite
            &lt;/web-resource-name&gt;
            &lt;url-pattern&gt;/secured/*&lt;/url-pattern&gt;
            &lt;http-method&gt;GET&lt;/http-method&gt;
            &lt;http-method&gt;POST&lt;/http-method&gt;
        &lt;/web-resource-collection&gt;
        &lt;auth-constraint&gt;
            &lt;description&gt;
            Let only managers use this app
            &lt;/description&gt;
            &lt;role-name&gt;manager&lt;/role-name&gt;
        &lt;/auth-constraint&gt;
    &lt;/security-constraint&gt;
    &lt;security-role&gt;
  	   &lt;role-name&gt;manager&lt;/role-name&gt;
    &lt;/security-role&gt;
    &lt;login-config&gt;
      &lt;auth-method&gt;FORM&lt;/auth-method&gt;
      &lt;form-login-config&gt;
        &lt;form-login-page&gt;/login.jsp&lt;/form-login-page&gt;
        &lt;form-error-page&gt;/error.jsp&lt;/form-error-page&gt;
      &lt;/form-login-config&gt;
    &lt;/login-config&gt;
...
&lt;/web-app&gt;
</pre>
<p>Now when you try to access any resource with URL /secured/*, it would display above form asking for user id and password. When the container sees the "j_security_check" action, it uses some internal mechanism to authenticate the caller.</p>
<p>If the login succeeds and the caller is authorized to access the secured resource, then the container uses a session-id to identify a login session for the caller from that point on. The container maintains the login session with a cookie containing the session-id. The server sends the cookie back to the client, and as long as the caller presents this cookie with subsequent requests, then the container will know who the caller is.</p>
<p>If the login fails, then the server sends back the page identified by the form-error-page setting</p>
<p>Here j_security_check is the action that applications using form based login have to specify for the login form. In the same form you should also have a text input control called j_username and a password input control called j_password. When you see this it means that the information contained in the form will be submitted to the server, which will check name and password. How this is done is server specific.</p>
<p>Check <a href="http://tomcat.apache.org/tomcat-5.5-doc/realm-howto.html" target="_blank">Standard Realm Implementations</a> to understand how j_security_check works for Tomcat container.</p>
<h2>Programmatic Security in a Servlet/JSP:</h2>
<p>The HttpServletRequest object provides the following methods, which can be used to mine security information at runtime:</p>
<table class="src">
<tr><th style="width:5">SN</th><th>Method and Description </th></tr>
<tr><td>1</td><td><b>String getAuthType()</b><br />The getAuthType() method returns a String object that represents the name of the authentication scheme used to protect the Servlet.</td></tr>
<tr><td>2</td><td><b>boolean isUserInRole(java.lang.String role)</b><br />The isUserInRole() method returns a boolean value: true if the user is in the given role or false if they are not.</td></tr>
<tr><td>3</td><td><b>String getProtocol()</b><br />The getProtocol() method returns a String object representing the protocol that was used to send the request. This value can be checked to determine if a secure protocol was used.</td></tr>
<tr><td>4</td><td><b>boolean isSecure()</b><br />The isSecure() method returns a boolean value representing if the request was made using HTTPS. A value of true means it was and the connection is secure. A value of false means the request was not.</td></tr>
<tr><td>5</td><td><b>Principle getUserPrinciple()</b><br />The getUserPrinciple() method returns a java.security.Principle object that contains the name of the current authenticated user.</td></tr>
</table>
<p>For example, a JavaServer Page that links to pages for managers, you might have the following code:</p>
<pre class="prettyprint">
&lt;% if (request.isUserInRole("manager")) { %&gt;
&lt;a href="managers/mgrreport.jsp"&gt;Manager Report&lt;/a&gt;
&lt;a href="managers/personnel.jsp"&gt;Personnel Records&lt;/a&gt;
&lt;% } %&gt;
</pre>
<p>By checking the user's role in a JSP or servlet, you can customize the Web page to show the user only the items she can access. If you need the user's name as it was entered in the authentication form, you can call getRemoteUser method in the request object.</p>
<hr />
<div class="pre-btn">
<a href="jsp_debugging.html">Previous Page</a>
</div>
<div class="print-btn">
<a href="../cgi-bin/printpage.html" target="_blank">Print Version</a>
</div>
<div class="pdf-btn">
<a href="pdf/jsp_security.pdf" alt="JSP - Security" target="_blank">PDF Version</a>
</div>
<div class="nxt-btn">
<a href="jsp_internationalization.html">Next Page</a>
</div>
<div class="clearer"></div>
<hr />
</div>
<!-- PRINTING ENDS HERE -->
<div class="bottomgooglead">
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 336;
google_ad_height = 280;
google_ad_format = "336x280_as";
google_ad_type = "text";
google_ad_channel ="9030538898";
google_color_border="ffffff";
google_color_link="900b09";
google_color_url="000000";
google_color_text="000000";
//--></script>
<script type="text/javascript" src="../../pagead2.googlesyndication.com/pagead/show_ads.js"></script>
</div>
</div><!-- middlecol -->
<div id="rightcol">
<!-- AddThis Button BEGIN -->
<div class="addthis">
<div class="addthis_toolbox addthis_default_style">
<a class="addthis_button_facebook"></a>
<a class="addthis_button_twitter"></a>
<script type="text/javascript">
<!--
 document.write('<a class="addthis_button_google_plusone" g:plusone:count="false"></a>');
//-->
</script>
<a class="addthis_button_linkedin"></a>
<a class="addthis_button_email"></a>
<a class="addthis_button_compact"></a>
</div>
<script type="text/javascript" src="../../s7.addthis.com/js/250/addthis_widget.js#pubid=ra-4f661ec623a400f0"></script>
</div>
<!-- AddThis Button END -->
<div class="localad">
<a rel="nofollow" href="http://www.modernindianbabynames.com/" target="_blank" title="Modern Baby Names">Modern Baby Names</a>
</div>
<div class="localad">
<a rel="nofollow" href="http://www.photofuntoos.com/" target="_blank" title="Online Photo Editing">Online Photo Editing</a>
</div>
<div class="rightgooglead">
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/show_ads.js"> 
</script>
</div>
</div><!-- rightcol -->
<div style="clear:both;"></div>
</div><!-- wrapper -->
<div id="footer">
<div class="wrapper">
<div id="bottommenu">
<a href="../asp.net/index.html" target="_top">ASP.NET </a> |
<a href="../jquery/index.html" target="_top">jQuery </a> |
<a href="../ajax/index.html" target="_top">AJAX </a> |
<a href="../ant/index.html" target="_top">ANT</a> |
<a href="index.html" target="_top">JSP </a> |
<a href="../servlets/index.html" target="_top">Servlets </a> |
<a href="../log4j/index.html" target="_top">log4j </a> |
<a href="../ibatis/index.html" target="_top">iBATIS </a> |
<a href="../hibernate/index.html" target="_top">Hibernate </a> |
<a href="../jdbc/index.html" target="_top">JDBC </a> |
<a href="../struts_2/index.html" target="_top">Struts </a> |
<a href="../html5/index.html" target="_top">HTML5 </a> |
<a href="../sql/index.html" target="_top">SQL </a> |
<a href="../mysql/index.html" target="_top">MySQL </a> |
<a href="../cplusplus/index.html" target="_top">C++ </a> |
<a href="../unix/index.html" target="_top">UNIX </a>
</div>
<div id="copyright">
<p>Copyright &copy; 2012 by tutorialspoint. All Rights Reserved.</p>
</div>
</div>
</div>
</body>

<!-- Mirrored from www.tutorialspoint.com/jsp/jsp_security.htm by HTTrack Website Copier/3.x [XR&CO'2010], Sun, 14 Apr 2013 19:40:39 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
</html>