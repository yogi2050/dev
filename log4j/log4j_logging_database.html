<!doctype html> 
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]> <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]> <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]> <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--><html lang="en"><!--<![endif]-->

<!-- Mirrored from www.tutorialspoint.com/log4j/log4j_logging_database.htm by HTTrack Website Copier/3.x [XR&CO'2010], Sun, 14 Apr 2013 19:43:28 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8">
<title>log4j| log4j Logging in Database with JDBCAppender| Configuring JDBCAppender| How to use log4j with JDBC</title>
<link rel="shortcut icon" href="../favicon.png" type="image/x-icon" />
<meta name="description" content="log4j| log4j Logging in Database with JDBCAppender| Configuring JDBCAppender| How to use log4j with JDBC. Learn how log4j framework works starting from environment setup, logging levels, methods, formatting, methods, file logging and database logging." />
<meta name="Keywords" content="Free, log4j, Tutorials, Reference, Manual, Guide, Beginners" />
<base  />
<link rel="stylesheet" type="text/css" href="../scripts/style.css" />
<link rel="stylesheet" type="text/css" href="../scripts/prettify.css" />
<script type="text/javascript" src="../scripts/prettify.js"></script>
<style media="screen" type="text/css">
#topmenu a:hover {text-decoration:none;color:#afd5a6 !important;background-color:transparent;font-weight:bold;}
#header{ 
background:#afd5a6 !important;
}
#topmenu
{
background-color:#488A36 !important;
}
#leftcol ul.menu li.heading 
{
background:#afd5a6 !important;
border:1px solid #488A36 !important;
}
#leftcol, #middlecol, #rightcol {min-height:1020px; padding:0px;}
</style>
<script src="../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-232293-6";
urchinTracker();
</script>
</head>
<body onload="prettyPrint()">
<div id="header">
<div class="wrapper">
<h1 class="logo"><a href="../index-2.html">Tutorials Point - Simply Easy Learning</a></h1>
<div id="search">
<form method="get" id="searchform" name="searchform" action="http://www.google.com/search" target="_blank">
<input type="hidden" name="sitesearch" value="www.tutorialspoint.com"/>
<input type="text" name="as_q" id="s" value="Search this site..." onfocus="if (this.value == 'Search this site...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search this site...';}"/>
<input value="FORID:11" name="cof" type="hidden"/>
<input type="hidden" name="ie" value="ISO-8859-1" />
<input class="submit btn" type="image" src="../images/icon-search.png" alt="Go"/>
</form>
</div>
</div>
</div>
<div id="topmenu">
<div class="wrapper">
<div id="left">
<a href="../index-2.html" target="_top">HOME </a>
<a href="../java/index.html" target="_top">JAVA </a>
<a href="../php/index.html" target="_top">PHP </a>
<a href="../python/index.html" target="_top">Python </a>
<a href="../ruby/index.html" target="_top">Ruby </a>
<a href="../perl/index.html" target="_top">Perl </a>
<a href="../html/index.html" target="_top">HTML </a>
<a href="../css/index.html" target="_top">CSS </a>
<a href="../javascript/index.html" target="_top">Javascript </a>
<a href="../mysql/index.html" target="_top">MySQL </a>
<a href="../cplusplus/index.html" target="_top">C++ </a>
<a href="../unix/index.html" target="_top">UNIX </a>
<a href="../more.html" target="_top">MORE...</a>
</div>
<div id="right">
<a href="../references.html" target="_top">REFERENCES</a> |
<a href="../forums/index.html" target="_top">FORUM</a> |
<a href="../about/index.html" target="_top">ABOUT</a> |
<a href="../about/contact_us.html" target="_top">CONTACT</a>
</div>
</div>
</div>
<div class="wrapper">
<div id="leftcol">
<div class="mini-logo">
<img src="../images/log4j-mini-logo.png" alt="log4j Tutorial" />
</div>
<ul class="menu">
<li class="heading">log4j Tutorial</li>
<li><a target="_top" href="index.html">log4j - Home</a></li>
<li><a target="_top" href="log4j_overview.html">log4j - Overview</a></li>
<li><a target="_top" href="log4j_installation.html">log4j - Installation</a></li>
<li><a target="_top" href="log4j_architecture.html">log4j - Architecture</a></li>
<li><a target="_top" href="log4j_configuration.html">log4j - Configuration</a></li>
<li><a target="_top" href="log4j_sample_program.html">log4j - Sample Program</a></li>
<li><a target="_top" href="log4j_logging_methods.html">log4j - Logging Methods</a></li>
<li><a target="_top" href="log4j_logging_levels.html">log4j - Logging Levels</a></li>
<li><a target="_top" href="log4j_log_formatting.html">log4j - Log Formatting</a></li>
<li><a target="_top" href="log4j_logging_files.html">log4j - Logging in Files</a></li>
<li><a target="_top" href="log4j_logging_database.html"><b>log4j - Logging in Database</b></a></li>
</ul>
<ul class="menu">
<li class="heading">log4j Useful Resources</li>
<li><a target="_top" href="log4j_quick_guide.html">log4j - Quick Guide</a></li>
<li><a target="_top" href="log4j_useful_resources.html">log4j - Useful Resources</a></li>
</ul>
<ul class="menu">
<li class="sreading">Selected Reading</li>
<li><a target="_top" href="../developers_best_practices/index.html">Developer's Best Practices</a></li>
<li><a target="_top" href="../computer_glossary.html">Computer Glossary</a></li>
<li><a target="_top" href="../computer_whoiswho.html">Who is Who</a></li>
</ul>
</div><!-- leftcol -->
<div id="middlecol">
<!-- PRINTING STARTS HERE -->
<div class="content">
<h1>log4j - Logging in Database</h1>
<div class="topgooglead">
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "image";
google_ad_channel = "";
//--></script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/show_ads.js"> 
</script>
</div>
<hr />
<div class="pre-btn">
<a href="log4j_logging_files.html">Previous Page</a>
</div>
<div class="nxt-btn">
<a href="log4j_quick_guide.html">Next Page</a>
</div>
<div class="clearer"></div>
<hr />
<p>The log4j API provides the <i>org.apache.log4j.jdbc.JDBCAppender</i> object, which is capable of putting logging information in a specified database.</p>
<h2>JDBCAppender Configuration:</h2>
<table class="src">
<tr><th style="width:25%">Property</th><th>Description</th></tr>
<tr><td>bufferSize</td><td>Sets the buffer size. Default size is 1.</td></tr>
<tr><td>driver</td><td>Sets the driver class to the specified string. If no driver class is specified, defaults to sun.jdbc.odbc.JdbcOdbcDriver.</td></tr>
<tr><td>layout </td><td>Sets the layout to be used. Default layout is org.apache.log4j.PatternLayout.</td></tr>
<tr><td>password</td><td>Sets the database password.</td></tr>
<tr><td>sql</td><td>Specifies SQL statement to be executed every time a logging event occurs. This could be INSERT, UPDATE, or DELETE.</td></tr>
<tr><td>URL</td><td>Sets the JDBC URL </td></tr>
<tr><td>user</td><td>Sets the database user name</td></tr>
</table>
<h2>Log Table Configuration:</h2>
<p>Before you start using JDBC based logging, you shold create a table where all the log information would be maintained. Following is the SQL Statement for Creating the LOGS Table:</p>
<pre class="prettyprint">
CREATE TABLE LOGS
   (USER_ID VARCHAR(20) NOT NULL,
    DATED   DATE NOT NULL,
    LOGGER  VARCHAR(50) NOT NULL,
    LEVEL   VARCHAR(10) NOT NULL,
    MESSAGE VARCHAR(1000) NOT NULL
   );
</pre>
<h2>Sample Configuration File:</h2>
<p>Following is a sample configuration file <i>log4j.properties</i> for JDBCAppender which will be used to log messages to a LOGS table.</p>
<pre class="prettyprint">
# Define the root logger with appender file
log4j.rootLogger = DEBUG, DB

# Define the DB appender
log4j.appender.DB=org.apache.log4j.jdbc.JDBCAppender

# Set JDBC URL
log4j.appender.DB.URL=jdbc:mysql://localhost/DBNAME

# Set Database Driver
log4j.appender.DB.driver=com.mysql.jdbc.Driver

# Set database user name and password
log4j.appender.DB.user=user_name
log4j.appender.DB.password=password

# Set the SQL statement to be executed.
log4j.appender.DB.sql=INSERT INTO LOGS 
                      VALUES('%x','%d','%C','%p','%m')

# Define the layout for file appender
log4j.appender.DB.layout=org.apache.log4j.PatternLayout
</pre>
<p>Here for a MySQL database, you would have to use actual DBNAME, user id and password where you have created LOGS table.  The SQL statement is to execute an INSERT statement with the table name LOGS and values to be entered into the table.</p>
<p>The JDBCAppender does not need a layout to be defined explicitly. Instead, the SQL statement passed to it uses a PatternLayout</p>
<p>If you like to have an XML configuration file equivalent to above <i>log4j.properties</i> file, then here is the content:</p>
<pre class="prettyprint">
&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;!DOCTYPE log4j:configuration SYSTEM "log4j.dtd"&gt;
&lt;log4j:configuration&gt;

&lt;appender name="DB" class="org.apache.log4j.jdbc.JDBCAppender"&gt;
   &lt;param name="url" value="jdbc:mysql://localhost/DBNAME"/&gt;
   &lt;param name="driver" value="com.mysql.jdbc.Driver"/&gt;
   &lt;param name="user" value="user_id"/&gt;
   &lt;param name="password" value="password"/&gt;
   &lt;param name="sql" value="INSERT INTO LOGS VALUES('%x',
                             '%d','%C','%p','%m')"/&gt;
   &lt;layout class="org.apache.log4j.PatternLayout"&gt;
   &lt;/layout&gt;

&lt;/appender&gt;

&lt;logger name="log4j.rootLogger" additivity="false"&gt;
   &lt;level value="DEBUG"/&gt;
   &lt;appender-ref ref="DB"/&gt;
&lt;/logger&gt;

&lt;/log4j:configuration&gt;
</pre>
<h2>Sample Program:</h2>
<p>The following Java class is a very simple example that initializes, and then uses, the Log4J logging library for Java applications.</p>
<pre class="prettyprint">
import org.apache.log4j.Logger;
import java.sql.*;
import java.io.*;
import java.util.*;

public class log4jExample{
  /* Get actual class name to be printed on */
  static Logger log = Logger.getLogger(
                      log4jExample.class.getName());

  public static void main(String[] args)
                throws IOException,SQLException{

     log.debug("Debug");
     log.info("Info");
  }
}
</pre>
<h2>Compilation and Run:</h2>
<p>Here are the steps to compile and run the above mentioned program. Make sure you have set PATH and CLASSPATH appropriately before proceeding for the compilation and execution.</p>
<p>All the libraries should be available in CLASSPATH and your <i>log4j.properties</i> file should be available in PATH. So do the following:</p>
<ul class="list">
<li><p>Create log4j.properties as shown above.</p></li>
<li><p>Create log4jExample.java as shown above and compile it.</p></li>
<li><p>Execute log4jExample binary to run the program.</p></li>
</ul>
<p>Now check your LOGS table inside DBNAME database and you would find following entries:</p>
<pre class="prettyprint">
mysql &gt;  select * from LOGS;
+---------+------------+--------------+-------+---------+
| USER_ID | DATED      | LOGGER       | LEVEL | MESSAGE |
+---------+------------+--------------+-------+---------+
|         | 2010-05-13 | log4jExample | DEBUG | Debug   |
|         | 2010-05-13 | log4jExample | INFO  | Info    |
+---------+------------+--------------+-------+---------+
2 rows in set (0.00 sec)
</pre>
<p><b>NOTE:</b> Here x is used to output the NDC (nested diagnostic context) associated with the thread that generated the logging event. We use NDC to distinguish clients in server-side components handling multiple clients. Check Log4J Manual for more information on this.</p>
<hr />
<div class="pre-btn">
<a href="log4j_logging_files.html">Previous Page</a>
</div>
<div class="print-btn">
<a href="../cgi-bin/printpage.html" target="_blank">Print Version</a>
</div>
<div class="pdf-btn">
<a href="pdf/log4j_logging_database.pdf" alt="log4j| log4j Logging in Database with JDBCAppender| Configuring JDBCAppender| How to use log4j with JDBC" target="_blank">PDF Version</a>
</div>
<div class="nxt-btn">
<a href="log4j_quick_guide.html">Next Page</a>
</div>
<div class="clearer"></div>
<hr />
</div>
<!-- PRINTING ENDS HERE -->
<div class="bottomgooglead">
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 336;
google_ad_height = 280;
google_ad_format = "336x280_as";
google_ad_type = "text";
google_ad_channel ="9030538898";
google_color_border="ffffff";
google_color_link="900b09";
google_color_url="000000";
google_color_text="000000";
//--></script>
<script type="text/javascript" src="../../pagead2.googlesyndication.com/pagead/show_ads.js"></script>
</div>
</div><!-- middlecol -->
<div id="rightcol">
<!-- AddThis Button BEGIN -->
<div class="addthis">
<div class="addthis_toolbox addthis_default_style">
<a class="addthis_button_facebook"></a>
<a class="addthis_button_twitter"></a>
<script type="text/javascript">
<!--
 document.write('<a class="addthis_button_google_plusone" g:plusone:count="false"></a>');
//-->
</script>
<a class="addthis_button_linkedin"></a>
<a class="addthis_button_email"></a>
<a class="addthis_button_compact"></a>
</div>
<script type="text/javascript" src="../../s7.addthis.com/js/250/addthis_widget.js#pubid=ra-4f661ec623a400f0"></script>
</div>
<!-- AddThis Button END -->
<div class="localad">
<a rel="nofollow" href="http://www.modernindianbabynames.com/" target="_blank" title="Modern Baby Names">Modern Baby Names</a>
</div>
<div class="localad">
<a rel="nofollow" href="http://www.photofuntoos.com/" target="_blank" title="Online Photo Editing">Online Photo Editing</a>
</div>
<div class="rightgooglead">
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/show_ads.js"> 
</script>
</div>
</div><!-- rightcol -->
<div style="clear:both;"></div>
</div><!-- wrapper -->
<div id="footer">
<div class="wrapper">
<div id="bottommenu">
<a href="../asp.net/index.html" target="_top">ASP.NET </a> |
<a href="../jquery/index.html" target="_top">jQuery </a> |
<a href="../ajax/index.html" target="_top">AJAX </a> |
<a href="../ant/index.html" target="_top">ANT</a> |
<a href="../jsp/index.html" target="_top">JSP </a> |
<a href="../servlets/index.html" target="_top">Servlets </a> |
<a href="index.html" target="_top">log4j </a> |
<a href="../ibatis/index.html" target="_top">iBATIS </a> |
<a href="../hibernate/index.html" target="_top">Hibernate </a> |
<a href="../jdbc/index.html" target="_top">JDBC </a> |
<a href="../struts_2/index.html" target="_top">Struts </a> |
<a href="../html5/index.html" target="_top">HTML5 </a> |
<a href="../sql/index.html" target="_top">SQL </a> |
<a href="../mysql/index.html" target="_top">MySQL </a> |
<a href="../cplusplus/index.html" target="_top">C++ </a> |
<a href="../unix/index.html" target="_top">UNIX </a>
</div>
<div id="copyright">
<p>Copyright &copy; 2013 by tutorialspoint. All Rights Reserved.</p>
</div>
</div>
</div>
</body>

<!-- Mirrored from www.tutorialspoint.com/log4j/log4j_logging_database.htm by HTTrack Website Copier/3.x [XR&CO'2010], Sun, 14 Apr 2013 19:43:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
</html>